!function(){"use strict";function e(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class t{constructor(t,s,r,i,n,o){e(this,"isLiked",(()=>this._likes.find((e=>e._id===this._userId)))),e(this,"deleteCard",(()=>{this._element.remove(),this._element=null})),this._data=t,this._name=t.name,this._link=t.link,this._likes=t.likes,this._id=t._id,this._userId=s,this._cardSelector=r,this._handleLike=n,this._handleDelete=o,this._handleCardClick=i}getId(){return this._id}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".grid__card").cloneNode(!0)}generateCard(){this._element=this._getTemplate(),this._setEventListeners();const e=this._element.querySelector(".card__image"),t=this._element.querySelector(".card__title");return e.style.backgroundImage="url(".concat(this._link,")"),t.textContent=this._title,this._countLikes(),this._element}_setEventListeners(){this._element.querySelector(".card__like").addEventListener("click",(()=>this._handleLike(this._id))),this._element.querySelector(".card__delete").addEventListener("click",(()=>this._handleDelete(this._id))),this._element.querySelector(".card__image").addEventListener("click",(()=>{this._handleCardClick()}))}getLikes(e){this._likes=e,this._countLikes()}_countLikes(){const e=this._element.querySelector(".card__like");this._element.querySelector(".card__like-counter").textContent=this._likes.length,this.isLiked()&&e.classList.toggle("card__like_active")}}function s(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var r=class{constructor(e,t){s(this,"_showInputError",((e,t)=>{const s=this._element.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)})),s(this,"_hideInputError",(e=>{const t=this._element.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.classList.remove(this._inputErrorClass),t.textContent=""})),s(this,"_checkInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)})),s(this,"_toggleButtonState",(()=>{this._hasInvalidInput(this._inputList)?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)})),this._inputSelector=e.inputSelector,this._fieldsetSelector=e.fieldsetSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._element=t,this._inputList=Array.from(t.querySelectorAll(this._inputSelector)),this._buttonElement=t.querySelector(this._submitButtonSelector)}resetValidationError(){this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_setEventListeners(){this._element.addEventListener("submit",(function(e){e.preventDefault()})),this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._element.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}};class i{constructor(e){var t,s;s=e=>{e.target===e.currentTarget&&this.close(e.target)},(t="_handleLayoverClose")in this?Object.defineProperty(this,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[t]=s,this._popupElement=e,this._handleEscClose=this._handleEscClose.bind(this),this._handleLayoverClose=this._handleLayoverClose.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}open(){this._popupElement.classList.add("popup_enabled"),document.addEventListener("keydown",this._handleEscClose),this._popupElement.addEventListener("mousedown",this._handleLayoverClose)}close(){this._popupElement.classList.remove("popup_enabled"),document.removeEventListener("keydown",this._handleEscClose),this._popupElement.removeEventListener("mousedown",this._handleLayoverClose)}setEventListeners(){this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("popup__close")&&this.close()}))}}class n extends i{constructor(e,t){super(e),this._handleFormSubmit=t,this._formElement=this._popupElement.querySelector(".popup__form"),this._inputList=this._formElement.querySelectorAll(".form__input")}_getInputValues(){const e={};return this._inputList.forEach((t=>{const s=t.id,r=t.value;e[s]=r})),e}setEventListeners(){super.setEventListeners(),this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}setInputValues(e){this._inputs.forEach((t=>{t.value=e[t.name]}))}close(){super.close(),this._formElement.reset()}}document.querySelector(".profile__name"),document.querySelector(".profile__category"),document.querySelector(".profile__picture");const o=document.querySelector(".profile__picture-overlay"),l=document.querySelector(".image"),a=(document.getElementById("title"),document.getElementById("link"),document.querySelector(".grid__cards"),document.querySelector(".profile__edit-button")),c=(document.querySelector(".edit__close"),document.querySelector(".edit")),d=(document.getElementById("editForm"),document.querySelector(".avatar")),u=document.querySelector("#edit"),h=document.querySelector("#add"),_=document.querySelector("#avatar"),m=document.querySelector("#delete"),p=document.getElementById("name"),E=document.getElementById("category"),f=document.getElementById("avatar"),y=document.querySelector(".profile__add-button"),g=(document.querySelector(".add__close"),document.querySelector(".add")),v=(document.getElementById("addForm"),document.querySelector(".form__button"),{formSelector:".form",inputSelector:".form__input",fieldsetSelector:".form__fieldset",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_inactive",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"}),b=(e,t)=>fetch(e,t).then((e=>e.ok?e.json():Promise.reject("Something went wrong: ".concat(e.status)))),S=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}getUserInfo(){return b("".concat(this._baseUrl,"/users/me"),{headers:this._headers})}editProfile(e){return b("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.description})})}editProfilePic(e){return b("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.picture})})}getInitialCards(){return b("".concat(this._baseUrl,"/cards"),{headers:this._headers})}renderCard(e){return b("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.title,link:e.link})})}likeCard(e){return b("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers})}unlikeCard(e){return b("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers})}deleteCard(e){return b("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers})}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"b451294b-44d9-464a-8874-2d4137a4eb3c","Content-Type":"application/json"}});let L;const C=new class{constructor(e){let{fullName:t,category:s,profilePic:r}=e;this._fullName=document.querySelector(t),this._category=document.querySelector(s),this._profilePic=document.querySelector(r)}getUserInfo(){return{name:this._fullName.textContent,description:this._category.textContent,picture:this._profilePic.src}}setUserInfo(e,t){this._fullName.textContent=e,this._category.textContent=t}setUserImage(e){this._profilePic.src=e}}({fullName:".profile__name",category:".profile__category",profilePic:".profile__picture"});Promise.all([S.getUserInfo(),S.getInitialCards()]).then((e=>{let[t,s]=e;L=t.id,C.setUserInfo(t.name,t.about),C.setUserImage(t.avatar),k.renderItems(s)})).catch((e=>{console.log(e)}));const k=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}addItem(e){const t=this._renderer(e);this._container.prepend(t)}renderItems(e){e.forEach((e=>{this.addItem(e)}))}}({renderer:function(e){const s=new t(e,L,"#card",(()=>{w.open(e.title,e.link)}),(()=>{s.isLiked()?S.unlikeCard(e.getId()).then((t=>{e.getLikes(t.number)})):S.likeCard(e.getId()).then((t=>{e.getLikes(t.number)}))}),(()=>{P.open(),P.submitDelete((()=>{S.deleteCard(id).then((()=>{s.deleteCard(),P.close()})).catch((e=>{console.log(e)})).finally((()=>{P.close()}))}))}));return s.generateCard()}},".grid__cards"),I=new n(u,(e=>{S.editProfile(e.name,e.description).then((t=>{C.setUserInfo(t.name,e.description)})).catch((e=>{console.log(e)})).finally((()=>{I.close()}))}));I.setEventListeners();const q=new n(h,(e=>{S.renderCard(e.title,e.link).then((e=>{console.log("res => ",e);const t={name:e.name,link:e.link,likes:e.likes,_id:e._id};k.addItem(t)})).catch((e=>{console.log(e)})).finally((()=>{q.close()}))}));q.setEventListeners();const w=new class extends i{constructor(e){super(e),this._imageTitle=this._popupElement.querySelector(".image__title"),this._imagePreview=this._popupElement.querySelector(".image__file")}open(e,t){super.open(),this._imagePreview.src=t,this._imagePreview.alt=e,this._imageTitle.textContent=e}}(l);w.setEventListeners();const B=new n(_,(e=>{S.editProfilePic(e.picture).then((e=>{C.setUserImage(e.picture)})).catch((e=>{console.log(e)})).finally((()=>{B.close()}))}));B.setEventListeners();const P=new class extends i{constructor(e){super(e),this._formElement=this._popupElement.querySelector(".popup__form"),this._submitButton=this._popupElement.querySelector("#submitButton"),this._text=this._submitButton.textContent}submitDelete(e){this._handleSubmit=e}setEventListeners(){this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()})),super.setEventListeners()}}(m);P.setEventListeners(),a.addEventListener("click",(function(){const e=C.getUserInfo();p.value=e.name,E.value=e.description,U.resetValidationError(),I.open()})),y.addEventListener("click",(()=>{x.resetValidationError(),q.open()})),o.addEventListener("click",(function(){const e=C.getUserInfo();f.value=e.picture,V.resetValidationError(),B.open()}));const U=new r(v,c),x=new r(v,g),V=new r(v,d);U.enableValidation(),x.enableValidation(),V.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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MUIsaUJBRUY3RSxLQUFLdU0sbUJBTVZ2RyxNQUFNSixzQkpzSHNCd0IsR0FDbkN1RSxFQUFXL0Ysb0JBbUVYaUIsRUFBVzVFLGlCQUFpQixTQXJCNUIsV0FDRSxNQUFNdUssRUFBVTFDLEVBQVNsQixjQUV6QnZCLEVBQVVmLE1BQVFrRyxFQUFROUwsS0FDMUI0RyxFQUFTaEIsTUFBUWtHLEVBQVFyRCxZQUV6QnNELEVBQWtCakksdUJBQ2xCc0gsRUFBWXBHLFVBZ0JkOEIsRUFBVXZGLGlCQUFpQixTQUFTLEtBQ2xDeUssRUFBaUJsSSx1QkFDakJ1SCxFQUFTckcsVUFHWGlCLEVBQWMxRSxpQkFBaUIsU0FsQi9CLFdBQ0UsTUFBTXVLLEVBQVUxQyxFQUFTbEIsY0FDekJyQixFQUFZakIsTUFBUWtHLEVBQVFsRCxRQUU1QnFELEVBQW9CbkksdUJBQ3BCNEgsRUFBVzFHLFVBa0JiLE1BQU0rRyxFQUFvQixJQUFJRyxFQUFjbEYsRUFBWVgsR0FDbEQyRixFQUFtQixJQUFJRSxFQUFjbEYsRUFBWUQsR0FDakRrRixFQUFzQixJQUFJQyxFQUFjbEYsRUFBWVYsR0FFMUR5RixFQUFrQjFILG1CQUNsQjJILEVBQWlCM0gsbUJBQ2pCNEgsRUFBb0I1SCxtQiIsInNvdXJjZXMiOlsid2VicGFjazovL3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwRm9ybS5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJvamVjdF80Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwRGVsZXRlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlxyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihkYXRhLCB1c2VySWQsIGNhcmRTZWxlY3RvciwgaGFuZGxlQ2FyZENsaWNrLCBoYW5kbGVMaWtlLCBoYW5kbGVEZWxldGUpIHtcclxuICAgIHRoaXMuX2RhdGEgPSBkYXRhO1xyXG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XHJcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xyXG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZSA9IGhhbmRsZUxpa2U7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGUgPSBoYW5kbGVEZWxldGU7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgfVxyXG5cclxuICBnZXRJZCgpe1xyXG4gICAgcmV0dXJuIHRoaXMuX2lkO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmdyaWRfX2NhcmRcIik7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIGNvbnN0IGNhcmRJbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIGNvbnN0IGNhcmRUaXRsZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuXHJcbiAgICBjYXJkSW1hZ2Uuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHVybCgke3RoaXMuX2xpbmt9KWA7XHJcbiAgICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl90aXRsZTtcclxuXHJcbiAgICB0aGlzLl9jb3VudExpa2VzKCk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvL2xpa2UgaGFuZGxlclxyXG4gICAgY29uc3QgY2FyZExpa2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZVwiKTtcclxuICAgIGNhcmRMaWtlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVMaWtlKHRoaXMuX2lkKSk7XHJcblxyXG5cclxuICAgIC8vZGVsZXRlIGhhbmRsZXJcclxuICAgIGNvbnN0IGNhcmREZWxldGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlXCIpO1xyXG4gICAgY2FyZERlbGV0ZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgICgpID0+IHRoaXMuX2hhbmRsZURlbGV0ZSh0aGlzLl9pZCkpO1xyXG5cclxuICAgIC8vaW1hZ2UgY2xpY2sgaGFuZGxlclxyXG4gICAgY29uc3QgY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7IHRoaXMuX2hhbmRsZUNhcmRDbGljaygpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBpc0xpa2VkID0gKCkgPT4ge1xyXG4gICAgcmV0dXJuIHRoaXMuX2xpa2VzLmZpbmQodXNlciA9PiB1c2VyLl9pZCA9PT0gdGhpcy5fdXNlcklkKTtcclxuICB9XHJcblxyXG4gIGdldExpa2VzKG51bWJlcil7XHJcbiAgICB0aGlzLl9saWtlcyA9IG51bWJlcjtcclxuICAgIHRoaXMuX2NvdW50TGlrZXMoKTtcclxuICB9XHJcblxyXG4gIF9jb3VudExpa2VzKCl7XHJcbiAgICBjb25zdCBjYXJkTGlrZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlXCIpO1xyXG4gICAgY29uc3QgY2FyZExpa2VDb3VudGVyID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtY291bnRlclwiKTtcclxuICAgIGNhcmRMaWtlQ291bnRlci50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcclxuXHJcbiAgICBpZih0aGlzLmlzTGlrZWQoKSl7XHJcbiAgICAgIGNhcmRMaWtlLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlX2FjdGl2ZVwiKTtcclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICAvL19oYW5kbGVDYXJkQ2xpY2sgPSAoKSA9PiB7XHJcbiAgIC8vIHRoaXMuUG9wdXBJbWFnZVxyXG4gLy8gfVxyXG5cclxuICAvL19wcmVzc0xpa2UgPSAoZXZ0KSA9PiB7XHJcbiAgICAvL2V2dC50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2VfYWN0aXZlXCIpO1xyXG4gIC8vfTtcclxuXHJcbiAgZGVsZXRlQ2FyZCA9ICgpID0+IHtcclxuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcclxuICB9O1xyXG59IiwiY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGNvbmZpZy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fZmllbGRzZXRTZWxlY3RvciA9IGNvbmZpZy5maWVsZHNldFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBjb25maWcuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IGNvbmZpZy5lcnJvckNsYXNzO1xyXG5cclxuICAgIHRoaXMuX2VsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IgPSAoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpID0+IHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH07XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvciA9IChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gIH07XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbkVycm9yKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkgPSAoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlID0gKCkgPT4ge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dExpc3QpKSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZnVuY3Rpb24gKGV2dCkge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGZ1bmN0aW9uIChldnQpIHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjsiLCJleHBvcnQgY2xhc3MgUG9wdXB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBFbGVtZW50KXtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IHBvcHVwRWxlbWVudDtcclxuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcclxuICAgIHRoaXMuX2hhbmRsZUxheW92ZXJDbG9zZSA9IHRoaXMuX2hhbmRsZUxheW92ZXJDbG9zZS5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xyXG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlTGF5b3ZlckNsb3NlID0gKGV2dCkgPT4ge1xyXG4gICAgaWYgKGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0KSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoZXZ0LnRhcmdldCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfZW5hYmxlZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZUxheW92ZXJDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfZW5hYmxlZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZUxheW92ZXJDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9fY2xvc2VcIikpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICB9KTtcclxuXHJcblxyXG59XHJcbn0iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwRWxlbWVudCwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgc3VwZXIocG9wdXBFbGVtZW50KTtcclxuXHJcblxyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX19pbnB1dFwiKTtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGlucHV0cyA9IHt9O1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBjb25zdCBrZXkgPSBpbnB1dC5pZDtcclxuICAgICAgY29uc3QgdmFsdWUgPSBpbnB1dC52YWx1ZTtcclxuICAgICAgaW5wdXRzW2tleV0gPSB2YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGlucHV0cztcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2V0SW5wdXRWYWx1ZXMoZGF0YSkge1xyXG4gICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpXHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpXHJcbn1cclxuXHJcbn0iLCIvL2luaXRpYWwgaW1hZ2VzXHJcblxyXG5leHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gICAge1xyXG4gICAgICB0aXRsZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS95b3NlbWl0ZS5qcGdcIixcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIHRpdGxlOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICB0aXRsZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgdGl0bGU6IFwiTGF0ZW1hclwiLFxyXG4gICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhdGVtYXIuanBnXCIsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICB0aXRsZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZ1wiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgdGl0bGU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiLFxyXG4gICAgfSxcclxuICBdO1xyXG4gIFxyXG4vL3Byb2ZpbGUgY29uc3RzXHJcblxyXG5leHBvcnQgY29uc3QgZnVsbE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XHJcbmV4cG9ydCBjb25zdCBjYXRlZ29yeSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fY2F0ZWdvcnlcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlUGljID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19waWN0dXJlXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZVBpY0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fcGljdHVyZS1vdmVybGF5XCIpO1xyXG5cclxuLy9pbWFnZSBjb25zdHNcclxuZXhwb3J0IGNvbnN0IHBvcHVwSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmltYWdlXCIpO1xyXG5leHBvcnQgY29uc3QgdGl0bGVJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGl0bGVcIik7XHJcbmV4cG9ydCBjb25zdCBsaW5rSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxpbmtcIik7XHJcblxyXG5cclxuZXhwb3J0IGNvbnN0IGNhcmRHcmlkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5ncmlkX19jYXJkc1wiKTtcclxuXHJcbi8vcHJvZmlsZSBmb3JtIGNvbnN0c1xyXG5cclxuZXhwb3J0IGNvbnN0IGJ1dHRvbkVkaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgY2xvc2VFZGl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0X19jbG9zZVwiKTtcclxuZXhwb3J0IGNvbnN0IGZvcm1FZGl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0XCIpO1xyXG5leHBvcnQgY29uc3QgZWRpdEZvcm1FbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlZGl0Rm9ybVwiKTtcclxuXHJcbi8vYXZhdGFyIGZvcm0gY29uc3RzXHJcblxyXG5leHBvcnQgY29uc3QgZm9ybUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYXZhdGFyXCIpO1xyXG5cclxuLy9kZWxldGUgZm9ybSBjb25zdHNcclxuXHJcblxyXG5cclxuLy9wb3B1cCBmb3JtIGNvbnN0c1xyXG5cclxuZXhwb3J0IGNvbnN0IGVkaXRQb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZWRpdCcpO1xyXG5leHBvcnQgY29uc3QgYWRkUG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2FkZCcpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFyUG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2F2YXRhcicpO1xyXG5leHBvcnQgY29uc3QgZGVsZXRlUG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2RlbGV0ZScpO1xyXG5cclxuLy9pbnB1dHNcclxuZXhwb3J0IGNvbnN0IG5hbWVJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibmFtZVwiKTtcclxuZXhwb3J0IGNvbnN0IGpvYklucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYXRlZ29yeVwiKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhcklucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhdmF0YXJcIik7XHJcblxyXG4vLyBpbWFnZSBmb3JtIGNvbnN0c1xyXG5leHBvcnQgY29uc3QgYnV0dG9uQWRkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgY2xvc2VBZGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFkZF9fY2xvc2VcIik7XHJcbmV4cG9ydCBjb25zdCBmb3JtQWRkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hZGRcIik7XHJcbmV4cG9ydCBjb25zdCBhZGRGb3JtRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRkRm9ybVwiKTtcclxuZXhwb3J0IGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2J1dHRvblwiKTtcclxuXHJcbi8vdmFsaWRhdGlvbiBjb25zdHNcclxuXHJcbmV4cG9ydCBjb25zdCBmb3JtQ29uZmlnID0ge1xyXG4gICAgZm9ybVNlbGVjdG9yOiBcIi5mb3JtXCIsXHJcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5mb3JtX19pbnB1dFwiLFxyXG4gICAgZmllbGRzZXRTZWxlY3RvcjogXCIuZm9ybV9fZmllbGRzZXRcIixcclxuICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19idXR0b25cIixcclxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwiZm9ybV9fYnV0dG9uX2luYWN0aXZlXCIsXHJcbiAgICBpbnB1dEVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gICAgZXJyb3JDbGFzczogXCJmb3JtX19pbnB1dC1lcnJvcl9hY3RpdmVcIixcclxuICB9OyIsImNvbnN0IGZldGNoZXIgPSAodXJsLCBoZWFkZXIpID0+IFxyXG4gICAgZmV0Y2godXJsLCBoZWFkZXIpLnRoZW4oKHJlcykgPT5cclxuICAgIHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChgU29tZXRoaW5nIHdlbnQgd3Jvbmc6ICR7cmVzLnN0YXR1c31gKVxyXG4gICAgICApOyBcclxuXHJcbiAgZXhwb3J0IGNsYXNzIEFwaSB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7YmFzZVVybCwgaGVhZGVyc30pe1xyXG4gICAgICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gICAgfTtcclxuXHJcbiAgICBnZXRVc2VySW5mbygpe1xyXG4gICAgICAgIHJldHVybiBmZXRjaGVyKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBlZGl0UHJvZmlsZShkYXRhKXtcclxuICAgICAgICByZXR1cm4gZmV0Y2hlciAoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBhYm91dDogZGF0YS5kZXNjcmlwdGlvblxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuICAgIGVkaXRQcm9maWxlUGljKGRhdGEpe1xyXG4gICAgICAgIHJldHVybiBmZXRjaGVyIChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBhdmF0YXI6IGRhdGEucGljdHVyZVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBnZXRJbml0aWFsQ2FyZHMoKXtcclxuICAgICAgICByZXR1cm4gZmV0Y2hlcihgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbiAgICByZW5kZXJDYXJkKGRhdGEpe1xyXG4gICAgICAgIHJldHVybiBmZXRjaGVyIChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS50aXRsZSxcclxuICAgICAgICAgICAgICAgIGxpbms6IGRhdGEubGlua1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgbGlrZUNhcmQoaWQpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2hlcihgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2lkfWAsIHtcclxuICAgICAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIFxyXG4gICAgdW5saWtlQ2FyZChpZCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaGVyKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7aWR9YCwge1xyXG4gICAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgXHJcbiAgICBkZWxldGVDYXJkKGlkKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoZXIoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH1gLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuICAgIFxyXG4gIH1cclxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHsgU2VjdGlvbiB9IGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgeyBDYXJkIH0gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgeyBQb3B1cEZvcm0gfSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwRm9ybS5qc1wiO1xyXG5cclxuaW1wb3J0IHsgUG9wdXBJbWFnZSB9IGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBJbWFnZS5qc1wiO1xyXG5cclxuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcblxyXG5pbXBvcnQgeyBQb3B1cERlbGV0ZSB9IGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBEZWxldGUuanNcIjtcclxuXHJcbmltcG9ydCB7XHJcbiAgZm9ybUNvbmZpZyxcclxuICBmb3JtQWRkLFxyXG4gIGZvcm1FZGl0LFxyXG4gIGZvcm1BdmF0YXIsXHJcbiAgYWRkUG9wdXBFbGVtZW50LFxyXG4gIGVkaXRQb3B1cEVsZW1lbnQsXHJcbiAgYXZhdGFyUG9wdXBFbGVtZW50LFxyXG4gIGRlbGV0ZVBvcHVwRWxlbWVudCxcclxuICBidXR0b25BZGQsXHJcbiAgYnV0dG9uRWRpdCxcclxuICBuYW1lSW5wdXQsXHJcbiAgam9iSW5wdXQsXHJcbiAgcG9wdXBJbWFnZSxcclxuICBhdmF0YXJJbnB1dCxcclxuICBwcm9maWxlUGljLFxyXG4gIHByb2ZpbGVQaWNCdG5cclxufSBmcm9tIFwiLi4vc2NyaXB0cy91dGlscy9jb25zdGFudHMuanNcIjtcclxuXHJcbmltcG9ydCB7IEFwaSB9IGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvQXBpLmpzXCI7XHJcblxyXG4vL2luaXRpYWxpemluZyBhcGlcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtMy1lblwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiYjQ1MTI5NGItNDRkOS00NjRhLTg4NzQtMmQ0MTM3YTRlYjNjXCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gIH1cclxufSk7XHJcblxyXG5sZXQgdXNlcklkO1xyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIGZ1bGxOYW1lOiBcIi5wcm9maWxlX19uYW1lXCIsXHJcbiAgY2F0ZWdvcnk6IFwiLnByb2ZpbGVfX2NhdGVnb3J5XCIsXHJcbiAgcHJvZmlsZVBpYzogXCIucHJvZmlsZV9fcGljdHVyZVwiXHJcbn0pO1xyXG5cclxuLy9nZXR0aW5nIGluaXRpYWwgY2FyZHMgYW5kIHByb2ZpbGUgaW5mb1xyXG5cclxuUHJvbWlzZS5hbGwoW2FwaS5nZXRVc2VySW5mbygpLCBhcGkuZ2V0SW5pdGlhbENhcmRzKCldKVxyXG4gIC50aGVuKChbdXNlckRhdGEsIGl0ZW1zXSkgPT4ge1xyXG4gICAgdXNlcklkID0gdXNlckRhdGEuaWQ7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YS5uYW1lLCB1c2VyRGF0YS5hYm91dCk7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW1hZ2UodXNlckRhdGEuYXZhdGFyKTtcclxuXHJcbiAgICBjYXJkTGlzdC5yZW5kZXJJdGVtcyhpdGVtcyk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge2NvbnNvbGUubG9nKGVycil9KVxyXG5cclxuLy9zdWJtaXR0aW5nIGNhcmRcclxuXHJcbmNvbnN0IHN1Ym1pdENhcmQgPSAoZGF0YSkgPT4ge1xyXG4gIGFwaS5yZW5kZXJDYXJkKGRhdGEudGl0bGUsIGRhdGEubGluaylcclxuICAudGhlbigocmVzKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZygncmVzID0+ICcsIHJlcylcclxuICAgIGNvbnN0IG5ld0ltYWdlID0ge1xyXG4gICAgICBuYW1lOiByZXMubmFtZSxcclxuICAgICAgbGluazogcmVzLmxpbmssXHJcbiAgICAgIGxpa2VzOiByZXMubGlrZXMsXHJcbiAgICAgIF9pZDogcmVzLl9pZFxyXG4gICAgfTtcclxuICAgIGNhcmRMaXN0LmFkZEl0ZW0obmV3SW1hZ2UpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHsgY29uc29sZS5sb2coZXJyKX0pXHJcbiAgLmZpbmFsbHkoICgpID0+IHsgY2FyZEZvcm0uY2xvc2UoKTt9KVxyXG5cclxuXHJcbn1cclxuXHJcbi8vc3VibWl0dGluZyBwcm9maWxlXHJcblxyXG5jb25zdCBzdWJtaXRQcm9maWxlID0gKGRhdGEpID0+IHtcclxuICBhcGkuZWRpdFByb2ZpbGUoZGF0YS5uYW1lLCBkYXRhLmRlc2NyaXB0aW9uKVxyXG4gIC50aGVuKChyZXMpID0+IHtcclxuICAgIFxyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzLm5hbWUsIGRhdGEuZGVzY3JpcHRpb24pXHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4geyBjb25zb2xlLmxvZyhlcnIpfSlcclxuICAuZmluYWxseSggKCkgPT4ge1xyXG4gICAgcHJvZmlsZUZvcm0uY2xvc2UoKTtcclxuICB9KVxyXG59XHJcblxyXG4vL3N1Ym1pdHRpbmcgcHJvZmlsZSBwaWNcclxuXHJcbmNvbnN0IHN1Ym1pdEF2YXRhciA9IChkYXRhKSA9PiB7XHJcbiAgYXBpLmVkaXRQcm9maWxlUGljKGRhdGEucGljdHVyZSlcclxuICAudGhlbigocmVzKSA9PiB7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW1hZ2UocmVzLnBpY3R1cmUpXHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4geyBjb25zb2xlLmxvZyhlcnIpfSlcclxuICAuZmluYWxseSggKCkgPT4geyBhdmF0YXJGb3JtLmNsb3NlKCl9KVxyXG5cclxufVxyXG5cclxuLy9kaXNwbGF5aW5nIGNhcmRzIGluIGdhbGxlcnlcclxuXHJcbmNvbnN0IGNhcmRMaXN0ID0gbmV3IFNlY3Rpb24oXHJcbiAge1xyXG4gICAgLy9pdGVtczogaW5pdGlhbENhcmRzLFxyXG4gICAgcmVuZGVyZXI6IHJlbmRlckNhcmQsXHJcbiAgfSxcclxuICBcIi5ncmlkX19jYXJkc1wiXHJcbik7XHJcblxyXG4vL2NhcmRMaXN0LnJlbmRlckl0ZW1zKCk7XHJcblxyXG4vL3VzZXIgaW5mbyBzZWN0aW9uXHJcblxyXG5jb25zdCBwcm9maWxlRm9ybSA9IG5ldyBQb3B1cEZvcm0oZWRpdFBvcHVwRWxlbWVudCwgc3VibWl0UHJvZmlsZSlcclxucHJvZmlsZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vY2FyZCBzZWN0aW9uXHJcblxyXG5jb25zdCBjYXJkRm9ybSA9IG5ldyBQb3B1cEZvcm0oYWRkUG9wdXBFbGVtZW50LCBzdWJtaXRDYXJkKVxyXG5jYXJkRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy9pbWFnZSBzZWN0aW9uXHJcblxyXG5jb25zdCBpbWFnZU1vZHVsZSA9IG5ldyBQb3B1cEltYWdlKHBvcHVwSW1hZ2UpO1xyXG5pbWFnZU1vZHVsZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy9hdmF0YXIgc2VjdGlvblxyXG5cclxuY29uc3QgYXZhdGFyRm9ybSA9IG5ldyBQb3B1cEZvcm0oYXZhdGFyUG9wdXBFbGVtZW50LCBzdWJtaXRBdmF0YXIpO1xyXG5hdmF0YXJGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL2RlbGV0ZSBzZWN0aW9uXHJcblxyXG5jb25zdCBkZWxldGVGb3JtID0gbmV3IFBvcHVwRGVsZXRlKGRlbGV0ZVBvcHVwRWxlbWVudCk7XHJcbmRlbGV0ZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcblxyXG4vL2FkZGluZyBjYXJkIHRvIGdhbGxlcnlcclxuXHJcbmZ1bmN0aW9uIHJlbmRlckNhcmQoZGF0YSkge1xyXG4gIGNvbnN0IGltYWdlID0gbmV3IENhcmQoZGF0YSwgXHJcbiAgICB1c2VySWQsXHJcbiAgICBcIiNjYXJkXCIsXHJcbiAgICAgKCkgPT4ge1xyXG4gICAgaW1hZ2VNb2R1bGUub3BlbihkYXRhLnRpdGxlLCBkYXRhLmxpbmspOyAvL2hhbmRsZUNhcmRDbGlja1xyXG4gIH0sXHJcbiAgKCkgPT4ge1xyXG4gICAgaWYgKGltYWdlLmlzTGlrZWQoKSl7XHJcbiAgICAgIGFwaS51bmxpa2VDYXJkKGRhdGEuZ2V0SWQoKSlcclxuICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICBkYXRhLmdldExpa2VzKHJlcy5udW1iZXIpXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgYXBpLmxpa2VDYXJkKGRhdGEuZ2V0SWQoKSlcclxuICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICBkYXRhLmdldExpa2VzKHJlcy5udW1iZXIpXHJcbiAgICB9KVxyXG4gIH1cclxufSwgKCkgPT4ge1xyXG4gIGRlbGV0ZUZvcm0ub3BlbigpO1xyXG4gIGRlbGV0ZUZvcm0uc3VibWl0RGVsZXRlKCgpID0+IHtcclxuICAgIGFwaS5kZWxldGVDYXJkKGlkKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBpbWFnZS5kZWxldGVDYXJkKCk7XHJcbiAgICAgIGRlbGV0ZUZvcm0uY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4geyBjb25zb2xlLmxvZyhlcnIpfSlcclxuICAuZmluYWxseSggKCkgPT4geyBkZWxldGVGb3JtLmNsb3NlKCl9KVxyXG4gIH0pXHJcbn1cclxuICApO1xyXG4gIHJldHVybiBpbWFnZS5nZW5lcmF0ZUNhcmQoKTtcclxufVxyXG5cclxuXHJcbi8vZ2V0dGluZyB0aGUgY3VycmVudCB1c2VyIGluZm9cclxuXHJcblxyXG5cclxuZnVuY3Rpb24gcmVuZGVyUHJvZmlsZSgpe1xyXG4gIGNvbnN0IHByb2ZpbGUgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG5cclxuICBuYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlLm5hbWVcclxuICBqb2JJbnB1dC52YWx1ZSA9IHByb2ZpbGUuZGVzY3JpcHRpb247XHJcbiAgXHJcbiAgZWRpdEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uRXJyb3IoKTtcclxuICBwcm9maWxlRm9ybS5vcGVuKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbmRlckF2YXRhcigpe1xyXG4gIGNvbnN0IHByb2ZpbGUgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIGF2YXRhcklucHV0LnZhbHVlID0gcHJvZmlsZS5waWN0dXJlO1xyXG5cclxuICBhdmF0YXJGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbkVycm9yKCk7XHJcbiAgYXZhdGFyRm9ybS5vcGVuKCk7XHJcbn1cclxuXHJcblxyXG4vL2hhbmRsZXJzXHJcblxyXG5idXR0b25FZGl0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCByZW5kZXJQcm9maWxlKTtcclxuXHJcbmJ1dHRvbkFkZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGFkZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uRXJyb3IoKTtcclxuICBjYXJkRm9ybS5vcGVuKCk7XHJcbn0pO1xyXG5cclxucHJvZmlsZVBpY0J0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgcmVuZGVyQXZhdGFyKVxyXG5cclxuXHJcbi8vdmFsaWRhdG9yIHNldHRpbmdzXHJcblxyXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1Db25maWcsIGZvcm1FZGl0KTtcclxuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1Db25maWcsIGZvcm1BZGQpO1xyXG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybUNvbmZpZywgZm9ybUF2YXRhcik7XHJcblxyXG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5hdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTsiLCJleHBvcnQgY2xhc3MgVXNlckluZm8ge1xyXG4gICAgY29uc3RydWN0b3IoeyBmdWxsTmFtZSwgY2F0ZWdvcnksIHByb2ZpbGVQaWMgfSkge1xyXG4gICAgICB0aGlzLl9mdWxsTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZnVsbE5hbWUpO1xyXG4gICAgICB0aGlzLl9jYXRlZ29yeSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY2F0ZWdvcnkpO1xyXG4gICAgICB0aGlzLl9wcm9maWxlUGljID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlUGljKTtcclxuICAgIH1cclxuICBcclxuICAgIGdldFVzZXJJbmZvKCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIG5hbWU6IHRoaXMuX2Z1bGxOYW1lLnRleHRDb250ZW50LFxyXG4gICAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLl9jYXRlZ29yeS50ZXh0Q29udGVudCxcclxuICAgICAgICBwaWN0dXJlOiB0aGlzLl9wcm9maWxlUGljLnNyY1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgXHJcbiAgICBzZXRVc2VySW5mbyggbmFtZSwgZGVzY3JpcHRpb24gKSB7XHJcbiAgICAgIHRoaXMuX2Z1bGxOYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgICAgdGhpcy5fY2F0ZWdvcnkudGV4dENvbnRlbnQgPSBkZXNjcmlwdGlvbjtcclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VySW1hZ2UocGljdHVyZSl7XHJcbiAgICAgIHRoaXMuX3Byb2ZpbGVQaWMuc3JjID0gcGljdHVyZTtcclxuICAgIH1cclxuXHJcbiAgfVxyXG4gICIsImV4cG9ydCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IHJlbmRlcmVyIH0sICBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAvLyB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgLy8gaW5zZXJ0cyBlbGVtZW50IHRvIHRoZSBjb250YWluZXJcclxuICBhZGRJdGVtKGl0ZW0pIHtcclxuICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLl9yZW5kZXJlcihpdGVtKVxyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudClcclxuICB9O1xyXG5cclxuICAvLyByZW5kZXJzIGluaXRpYWwgaXRlbXNcclxuICByZW5kZXJJdGVtcyhpdGVtcykge1xyXG4gICAgaXRlbXMuZm9yRWFjaCgoZGF0YSkgPT4ge1xyXG4gICAgICB0aGlzLmFkZEl0ZW0oZGF0YSlcclxuICAgIH0pXHJcbiAgfTtcclxufSIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQb3B1cEltYWdlIGV4dGVuZHMgUG9wdXB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cEVsZW1lbnQpe1xyXG4gICAgICAgIHN1cGVyKHBvcHVwRWxlbWVudCk7XHJcblxyXG4gICAgICAgIHRoaXMuX2ltYWdlVGl0bGUgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5pbWFnZV9fdGl0bGVcIik7XHJcbiAgICAgICAgdGhpcy5faW1hZ2VQcmV2aWV3ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaW1hZ2VfX2ZpbGVcIik7XHJcbiAgICB9XHJcblxyXG4gICAgb3Blbih0aXRsZSwgbGluayl7XHJcbiAgICBcclxuICAgICAgICBzdXBlci5vcGVuKClcclxuICAgIHRoaXMuX2ltYWdlUHJldmlldy5zcmMgPSBsaW5rO1xyXG4gICAgdGhpcy5faW1hZ2VQcmV2aWV3LmFsdCA9IHRpdGxlO1xyXG4gICAgdGhpcy5faW1hZ2VUaXRsZS50ZXh0Q29udGVudCA9IHRpdGxlO1xyXG5cclxuIFxyXG4gICAgfVxyXG59IiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwRGVsZXRlIGV4dGVuZHMgUG9wdXB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cEVsZW1lbnQpe1xyXG4gICAgICAgIHN1cGVyKHBvcHVwRWxlbWVudClcclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xyXG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI3N1Ym1pdEJ1dHRvblwiKTtcclxuICAgICAgICAvL3RoaXMuX2NhbmNlbEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhbmNlbEJ1dHRvblwiKTtcclxuICAgICAgICB0aGlzLl90ZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xyXG4gICAgfVxyXG5cclxuICAgIHN1Ym1pdERlbGV0ZShldnQpe1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGV2dDsgXHJcbiAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKXtcclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCgpO1xyXG5cclxuICAgICAgICB9KVxyXG4gICAgICAgLy8gdGhpcy5fY2FuY2VsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB7XHJcbiAgICAgICAgICAgIC8vdGhpcy5fZm9ybUVsZW1lbnQuY2xvc2UoKTtcclxuICAgICAgIC8vIH0pXHJcbiAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfVxyXG59Il0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJ1c2VySWQiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVMaWtlIiwiaGFuZGxlRGVsZXRlIiwidGhpcyIsIl9saWtlcyIsImZpbmQiLCJ1c2VyIiwiX2lkIiwiX3VzZXJJZCIsIl9lbGVtZW50IiwicmVtb3ZlIiwiX2RhdGEiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJsaWtlcyIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlTGlrZSIsIl9oYW5kbGVEZWxldGUiLCJfaGFuZGxlQ2FyZENsaWNrIiwiZ2V0SWQiLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiZ2VuZXJhdGVDYXJkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiY2FyZEltYWdlIiwiY2FyZFRpdGxlIiwic3R5bGUiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJ0ZXh0Q29udGVudCIsIl90aXRsZSIsIl9jb3VudExpa2VzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImdldExpa2VzIiwibnVtYmVyIiwiY2FyZExpa2UiLCJsZW5ndGgiLCJpc0xpa2VkIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiY29uZmlnIiwiZm9ybUVsZW1lbnQiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJpZCIsImFkZCIsIl9pbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfaW5wdXRMaXN0IiwiX2J1dHRvbkVsZW1lbnQiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImRpc2FibGVkIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX2ZpZWxkc2V0U2VsZWN0b3IiLCJmaWVsZHNldFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJyZXNldFZhbGlkYXRpb25FcnJvciIsImZvckVhY2giLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJzb21lIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiZW5hYmxlVmFsaWRhdGlvbiIsIlBvcHVwIiwicG9wdXBFbGVtZW50IiwidGFyZ2V0IiwiY3VycmVudFRhcmdldCIsImNsb3NlIiwiX3BvcHVwRWxlbWVudCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJfaGFuZGxlTGF5b3ZlckNsb3NlIiwia2V5Iiwib3BlbiIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsImNvbnRhaW5zIiwiUG9wdXBGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZm9ybUVsZW1lbnQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dHMiLCJpbnB1dCIsInZhbHVlIiwiZSIsInNldElucHV0VmFsdWVzIiwiX2lucHV0cyIsInJlc2V0IiwicHJvZmlsZVBpY0J0biIsInBvcHVwSW1hZ2UiLCJidXR0b25FZGl0IiwiZ2V0RWxlbWVudEJ5SWQiLCJmb3JtRWRpdCIsImZvcm1BdmF0YXIiLCJlZGl0UG9wdXBFbGVtZW50IiwiYWRkUG9wdXBFbGVtZW50IiwiYXZhdGFyUG9wdXBFbGVtZW50IiwiZGVsZXRlUG9wdXBFbGVtZW50IiwibmFtZUlucHV0Iiwiam9iSW5wdXQiLCJhdmF0YXJJbnB1dCIsImJ1dHRvbkFkZCIsImZvcm1BZGQiLCJmb3JtQ29uZmlnIiwiZm9ybVNlbGVjdG9yIiwiZmV0Y2hlciIsInVybCIsImhlYWRlciIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJhcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJnZXRVc2VySW5mbyIsImVkaXRQcm9maWxlIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsImRlc2NyaXB0aW9uIiwiZWRpdFByb2ZpbGVQaWMiLCJhdmF0YXIiLCJwaWN0dXJlIiwiZ2V0SW5pdGlhbENhcmRzIiwicmVuZGVyQ2FyZCIsInRpdGxlIiwibGlrZUNhcmQiLCJ1bmxpa2VDYXJkIiwiZGVsZXRlQ2FyZCIsImF1dGhvcml6YXRpb24iLCJ1c2VySW5mbyIsImZ1bGxOYW1lIiwiY2F0ZWdvcnkiLCJwcm9maWxlUGljIiwiX2Z1bGxOYW1lIiwiX2NhdGVnb3J5IiwiX3Byb2ZpbGVQaWMiLCJzcmMiLCJzZXRVc2VySW5mbyIsInNldFVzZXJJbWFnZSIsImFsbCIsInVzZXJEYXRhIiwiaXRlbXMiLCJjYXJkTGlzdCIsInJlbmRlckl0ZW1zIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiY29udGFpbmVyU2VsZWN0b3IiLCJyZW5kZXJlciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJhZGRJdGVtIiwiaXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiaW1hZ2UiLCJpbWFnZU1vZHVsZSIsImRlbGV0ZUZvcm0iLCJzdWJtaXREZWxldGUiLCJmaW5hbGx5IiwicHJvZmlsZUZvcm0iLCJjYXJkRm9ybSIsIm5ld0ltYWdlIiwiX2ltYWdlVGl0bGUiLCJfaW1hZ2VQcmV2aWV3IiwiYWx0IiwiYXZhdGFyRm9ybSIsIl9zdWJtaXRCdXR0b24iLCJfdGV4dCIsIl9oYW5kbGVTdWJtaXQiLCJwcm9maWxlIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJhZGRGb3JtVmFsaWRhdG9yIiwiYXZhdGFyRm9ybVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiXSwic291cmNlUm9vdCI6IiJ9