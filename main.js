!function(){"use strict";function e(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class t{constructor(t,s,r,i,n,o){e(this,"isLiked",(()=>this._likes.find((e=>e._id===this._userId)))),e(this,"deleteCard",(()=>{this._element.remove(),this._element=null})),this._data=t,this._title=t.title,this._link=t.link,this._likes=t.likes,this._id=t._id,this._userId=s,this._cardSelector=r,this._handleLike=n,this._handleDelete=o,this._handleCardClick=i}getId(){return this._id}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".grid__card").cloneNode(!0)}generateCard(){this._element=this._getTemplate(),this._setEventListeners();const e=this._element.querySelector(".card__image"),t=this._element.querySelector(".card__title");return e.style.backgroundImage="url(".concat(this._link,")"),t.textContent=this._title,this._element}_setEventListeners(){this._element.querySelector(".card__like").addEventListener("click",(()=>this._handleLike(this._id))),this._element.querySelector(".card__delete").addEventListener("click",(()=>this._handleDelete(this._id))),this._element.querySelector(".card__image").addEventListener("click",(()=>{this._handleCardClick()}))}getLikes(e){this._likes=e,this._countLikes()}_countLikes(){const e=this._element.querySelector(".card__like");this._element.querySelector(".card__like-counter").textContent=this._likes.length,this.isLiked()&&e.classList.toggle("card__like_active")}}function s(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var r=class{constructor(e,t){s(this,"_showInputError",((e,t)=>{const s=this._element.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)})),s(this,"_hideInputError",(e=>{const t=this._element.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.classList.remove(this._inputErrorClass),t.textContent=""})),s(this,"_checkInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)})),s(this,"_toggleButtonState",(()=>{this._hasInvalidInput(this._inputList)?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)})),this._inputSelector=e.inputSelector,this._fieldsetSelector=e.fieldsetSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._element=t,this._inputList=Array.from(t.querySelectorAll(this._inputSelector)),this._buttonElement=t.querySelector(this._submitButtonSelector)}resetValidationError(){this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_setEventListeners(){this._element.addEventListener("submit",(function(e){e.preventDefault()})),this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._element.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}};class i{constructor(e){var t,s;s=e=>{e.target===e.currentTarget&&this.close(e.target)},(t="_handleLayoverClose")in this?Object.defineProperty(this,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[t]=s,this._popupElement=e,this._handleEscClose=this._handleEscClose.bind(this),this._handleLayoverClose=this._handleLayoverClose.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}open(){this._popupElement.classList.add("popup_enabled"),document.addEventListener("keydown",this._handleEscClose),this._popupElement.addEventListener("mousedown",this._handleLayoverClose)}close(){this._popupElement.classList.remove("popup_enabled"),document.removeEventListener("keydown",this._handleEscClose),this._popupElement.removeEventListener("mousedown",this._handleLayoverClose)}setEventListeners(){this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("popup__close")&&this.close()}))}}class n extends i{constructor(e,t){super(e),this._handleFormSubmit=t,this._formElement=this._popupElement.querySelector(".popup__form"),this._inputList=this._formElement.querySelectorAll(".form__input")}_getInputValues(){const e={};return this._inputList.forEach((t=>{const s=t.id,r=t.value;e[s]=r})),e}setEventListeners(){super.setEventListeners(),this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}setInputValues(e){this._inputs.forEach((t=>{t.value=e[t.name]}))}close(){super.close(),this._formElement.reset()}}document.querySelector(".profile__name"),document.querySelector(".profile__category");const o=document.querySelector(".profile__picture"),l=document.querySelector(".image"),a=(document.getElementById("title"),document.getElementById("link"),document.querySelector(".grid__cards"),document.querySelector(".profile__edit-button")),c=(document.querySelector(".edit__close"),document.querySelector(".edit")),d=(document.getElementById("editForm"),document.querySelector(".avatar")),u=document.querySelector("#edit"),h=document.querySelector("#add"),_=document.querySelector("#avatar"),m=document.querySelector("#delete"),p=document.getElementById("name"),E=document.getElementById("category"),f=document.getElementById("avatar"),y=document.querySelector(".profile__add-button"),g=(document.querySelector(".add__close"),document.querySelector(".add")),v=(document.getElementById("addForm"),document.querySelector(".form__button"),{formSelector:".form",inputSelector:".form__input",fieldsetSelector:".form__fieldset",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_inactive",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"}),b=(e,t)=>fetch(e,t).then((e=>e.ok?e.json():Promise.reject("Something went wrong: ".concat(e.status)))),S=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}getUserInfo(){return b("".concat(this._baseUrl,"/users/me"),{headers:this._headers})}editProfile(e){return b("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.description})})}editProfilePic(e){return b("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.picture})})}getInitialCards(){return b("".concat(this._baseUrl,"/cards"),{headers:this._headers})}renderCard(e){return b("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.title,link:e.link})})}likeCard(e){return b("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers})}unlikeCard(e){return b("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers})}deleteCard(e){return b("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers})}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"b451294b-44d9-464a-8874-2d4137a4eb3c","Content-Type":"application/json"}});let L;const C=new class{constructor(e){let{fullName:t,category:s,profilePic:r}=e;this._fullName=document.querySelector(t),this._category=document.querySelector(s),this._profilePic=document.querySelector(r)}getUserInfo(){return{name:this._fullName.textContent,description:this._category.textContent,picture:this._profilePic.src}}setUserInfo(e,t){this._fullName.textContent=e,this._category.textContent=t}setUserImage(e){this._profilePic.src=e}}({fullName:".profile__name",category:".profile__category",profilePic:".profile__picture"});Promise.all([S.getUserInfo(),S.getInitialCards()]).then((e=>{let[t,s]=e;L=t.id,C.setUserInfo(t.name,t.about),C.setUserImage(t.avatar),k.renderItems(s)})).catch((e=>{console.log(e)}));const k=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}addItem(e){const t=this._renderer(e);this._container.prepend(t)}renderItems(e){e.forEach((e=>{this.addItem(e)}))}}({renderer:function(e){const s=new t(e,L,"#card",(()=>{w.open(e.title,e.link)}),(()=>{s.isLiked()?S.unlikeCard(e.getId()).then((t=>{e.getLikes(t.number)})):S.likeCard(e.getId()).then((t=>{e.getLikes(t.number)}))}),(()=>{P.open(),P.submitDelete((()=>{S.deleteCard(id).then((()=>{s.deleteCard(),P.close()})).catch((e=>{console.log(e)})).finally((()=>{P.close()}))}))}));return s.generateCard()}},".grid__cards"),I=new n(u,(e=>{S.editProfile(e.name,e.description).then((t=>{C.setUserInfo(t.name,e.description)})).catch((e=>{console.log(e)})).finally((()=>{I.close()}))}));I.setEventListeners();const q=new n(h,(e=>{S.renderCard(e.title,e.link).then((e=>{console.log("res => ",e);const t={name:e.name,link:e.link,likes:e.likes,_id:e._id};k.addItem(t)})).catch((e=>{console.log(e)})).finally((()=>{q.close()}))}));q.setEventListeners();const w=new class extends i{constructor(e){super(e),this._imageTitle=this._popupElement.querySelector(".image__title"),this._imagePreview=this._popupElement.querySelector(".image__file")}open(e,t){super.open(),this._imagePreview.src=t,this._imagePreview.alt=e,this._imageTitle.textContent=e}}(l);w.setEventListeners();const B=new n(_,(e=>{S.editProfilePic(e.picture).then((e=>{C.setUserImage(e.picture)})).catch((e=>{console.log(e)})).finally((()=>{B.close()}))}));B.setEventListeners();const P=new class extends i{constructor(e){super(e),this._formElement=this._popupElement.querySelector(".popup__form"),this._submitButton=this._popupElement.querySelector("#submitButton"),this._text=this._submitButton.textContent}submitDelete(e){this._handleSubmit=e}setEventListeners(){this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()})),super.setEventListeners()}}(m);P.setEventListeners(),a.addEventListener("click",(function(){const e=C.getUserInfo();p.value=e.name,E.value=e.description,U.resetValidationError(),I.open()})),y.addEventListener("click",(()=>{x.resetValidationError(),q.open()})),o.addEventListener("click",(function(){const e=C.getUserInfo();f.value=e.picture,V.resetValidationError(),B.open()}));const U=new r(v,c),x=new r(v,g),V=new r(v,d);U.enableValidation(),x.enableValidation(),V.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SnFIc0J5QixHQUNuQ3NFLEVBQVcvRixvQkFtRVhrQixFQUFXOUUsaUJBQWlCLFNBckI1QixXQUNFLE1BQU13SyxFQUFVMUMsRUFBU2pCLGNBRXpCdkIsRUFBVWhCLE1BQVFrRyxFQUFROUYsS0FDMUJhLEVBQVNqQixNQUFRa0csRUFBUXBELFlBRXpCcUQsRUFBa0JqSSx1QkFDbEJzSCxFQUFZcEcsVUFnQmQrQixFQUFVekYsaUJBQWlCLFNBQVMsS0FDbEMwSyxFQUFpQmxJLHVCQUNqQnVILEVBQVNyRyxVQUdYa0IsRUFBVzVFLGlCQUFpQixTQWxCNUIsV0FDRSxNQUFNd0ssRUFBVTFDLEVBQVNqQixjQUN6QnJCLEVBQVlsQixNQUFRa0csRUFBUWpELFFBRTVCb0QsRUFBb0JuSSx1QkFDcEI0SCxFQUFXMUcsVUFrQmIsTUFBTStHLEVBQW9CLElBQUlHLEVBQWNqRixFQUFZWCxHQUNsRDBGLEVBQW1CLElBQUlFLEVBQWNqRixFQUFZRCxHQUNqRGlGLEVBQXNCLElBQUlDLEVBQWNqRixFQUFZVixHQUUxRHdGLEVBQWtCMUgsbUJBQ2xCMkgsRUFBaUIzSCxtQkFDakI0SCxFQUFvQjVILG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBGb3JtLmpzIiwid2VicGFjazovL3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cEltYWdlLmpzIiwid2VicGFjazovL3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBEZWxldGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiXHJcblxyXG5cclxuZXhwb3J0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKGRhdGEsIHVzZXJJZCwgY2FyZFNlbGVjdG9yLCBoYW5kbGVDYXJkQ2xpY2ssIGhhbmRsZUxpa2UsIGhhbmRsZURlbGV0ZSkge1xyXG4gICAgdGhpcy5fZGF0YSA9IGRhdGE7XHJcbiAgICB0aGlzLl90aXRsZSA9IGRhdGEudGl0bGU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xyXG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcclxuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUxpa2UgPSBoYW5kbGVMaWtlO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlID0gaGFuZGxlRGVsZXRlO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gIH1cclxuXHJcbiAgZ2V0SWQoKXtcclxuICAgIHJldHVybiB0aGlzLl9pZDtcclxuICB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5ncmlkX19jYXJkXCIpO1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICBjb25zdCBjYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICBjb25zdCBjYXJkVGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcblxyXG4gICAgY2FyZEltYWdlLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHt0aGlzLl9saW5rfSlgO1xyXG4gICAgY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fdGl0bGU7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvL2xpa2UgaGFuZGxlclxyXG4gICAgY29uc3QgY2FyZExpa2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZVwiKTtcclxuICAgIGNhcmRMaWtlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVMaWtlKHRoaXMuX2lkKSk7XHJcblxyXG5cclxuICAgIC8vZGVsZXRlIGhhbmRsZXJcclxuICAgIGNvbnN0IGNhcmREZWxldGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlXCIpO1xyXG4gICAgY2FyZERlbGV0ZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgICgpID0+IHRoaXMuX2hhbmRsZURlbGV0ZSh0aGlzLl9pZCkpO1xyXG5cclxuICAgIC8vaW1hZ2UgY2xpY2sgaGFuZGxlclxyXG4gICAgY29uc3QgY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7IHRoaXMuX2hhbmRsZUNhcmRDbGljaygpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBpc0xpa2VkID0gKCkgPT4ge1xyXG4gICAgcmV0dXJuIHRoaXMuX2xpa2VzLmZpbmQodXNlciA9PiB1c2VyLl9pZCA9PT0gdGhpcy5fdXNlcklkKTtcclxuICB9XHJcblxyXG4gIGdldExpa2VzKG51bWJlcil7XHJcbiAgICB0aGlzLl9saWtlcyA9IG51bWJlcjtcclxuICAgIHRoaXMuX2NvdW50TGlrZXMoKTtcclxuICB9XHJcblxyXG4gIF9jb3VudExpa2VzKCl7XHJcbiAgICBjb25zdCBjYXJkTGlrZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlXCIpO1xyXG4gICAgY29uc3QgY2FyZExpa2VDb3VudGVyID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtY291bnRlclwiKTtcclxuICAgIGNhcmRMaWtlQ291bnRlci50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcclxuXHJcbiAgICBpZih0aGlzLmlzTGlrZWQoKSl7XHJcbiAgICAgIGNhcmRMaWtlLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlX2FjdGl2ZVwiKTtcclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICAvL19oYW5kbGVDYXJkQ2xpY2sgPSAoKSA9PiB7XHJcbiAgIC8vIHRoaXMuUG9wdXBJbWFnZVxyXG4gLy8gfVxyXG5cclxuICAvL19wcmVzc0xpa2UgPSAoZXZ0KSA9PiB7XHJcbiAgICAvL2V2dC50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2VfYWN0aXZlXCIpO1xyXG4gIC8vfTtcclxuXHJcbiAgZGVsZXRlQ2FyZCA9ICgpID0+IHtcclxuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcclxuICB9O1xyXG59IiwiY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGNvbmZpZy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fZmllbGRzZXRTZWxlY3RvciA9IGNvbmZpZy5maWVsZHNldFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBjb25maWcuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IGNvbmZpZy5lcnJvckNsYXNzO1xyXG5cclxuICAgIHRoaXMuX2VsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IgPSAoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpID0+IHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH07XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvciA9IChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gIH07XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbkVycm9yKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkgPSAoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlID0gKCkgPT4ge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dExpc3QpKSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZnVuY3Rpb24gKGV2dCkge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGZ1bmN0aW9uIChldnQpIHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjsiLCJleHBvcnQgY2xhc3MgUG9wdXB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBFbGVtZW50KXtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IHBvcHVwRWxlbWVudDtcclxuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcclxuICAgIHRoaXMuX2hhbmRsZUxheW92ZXJDbG9zZSA9IHRoaXMuX2hhbmRsZUxheW92ZXJDbG9zZS5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xyXG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlTGF5b3ZlckNsb3NlID0gKGV2dCkgPT4ge1xyXG4gICAgaWYgKGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0KSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoZXZ0LnRhcmdldCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfZW5hYmxlZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZUxheW92ZXJDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfZW5hYmxlZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZUxheW92ZXJDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9fY2xvc2VcIikpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICB9KTtcclxuXHJcblxyXG59XHJcbn0iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwRWxlbWVudCwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgc3VwZXIocG9wdXBFbGVtZW50KTtcclxuXHJcblxyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX19pbnB1dFwiKTtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGlucHV0cyA9IHt9O1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBjb25zdCBrZXkgPSBpbnB1dC5pZDtcclxuICAgICAgY29uc3QgdmFsdWUgPSBpbnB1dC52YWx1ZTtcclxuICAgICAgaW5wdXRzW2tleV0gPSB2YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGlucHV0cztcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2V0SW5wdXRWYWx1ZXMoZGF0YSkge1xyXG4gICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpXHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpXHJcbn1cclxuXHJcbn0iLCIvL2luaXRpYWwgaW1hZ2VzXHJcblxyXG5leHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gICAge1xyXG4gICAgICB0aXRsZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS95b3NlbWl0ZS5qcGdcIixcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIHRpdGxlOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICB0aXRsZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgdGl0bGU6IFwiTGF0ZW1hclwiLFxyXG4gICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhdGVtYXIuanBnXCIsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICB0aXRsZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZ1wiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgdGl0bGU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiLFxyXG4gICAgfSxcclxuICBdO1xyXG4gIFxyXG4vL3Byb2ZpbGUgY29uc3RzXHJcblxyXG5leHBvcnQgY29uc3QgZnVsbE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XHJcbmV4cG9ydCBjb25zdCBjYXRlZ29yeSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fY2F0ZWdvcnlcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlUGljID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19waWN0dXJlXCIpO1xyXG5cclxuLy9pbWFnZSBjb25zdHNcclxuZXhwb3J0IGNvbnN0IHBvcHVwSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmltYWdlXCIpO1xyXG5leHBvcnQgY29uc3QgdGl0bGVJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGl0bGVcIik7XHJcbmV4cG9ydCBjb25zdCBsaW5rSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxpbmtcIik7XHJcblxyXG5cclxuZXhwb3J0IGNvbnN0IGNhcmRHcmlkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5ncmlkX19jYXJkc1wiKTtcclxuXHJcbi8vcHJvZmlsZSBmb3JtIGNvbnN0c1xyXG5cclxuZXhwb3J0IGNvbnN0IGJ1dHRvbkVkaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgY2xvc2VFZGl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0X19jbG9zZVwiKTtcclxuZXhwb3J0IGNvbnN0IGZvcm1FZGl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0XCIpO1xyXG5leHBvcnQgY29uc3QgZWRpdEZvcm1FbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlZGl0Rm9ybVwiKTtcclxuXHJcbi8vYXZhdGFyIGZvcm0gY29uc3RzXHJcblxyXG5leHBvcnQgY29uc3QgZm9ybUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYXZhdGFyXCIpO1xyXG5cclxuLy9kZWxldGUgZm9ybSBjb25zdHNcclxuXHJcblxyXG5cclxuLy9wb3B1cCBmb3JtIGNvbnN0c1xyXG5cclxuZXhwb3J0IGNvbnN0IGVkaXRQb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZWRpdCcpO1xyXG5leHBvcnQgY29uc3QgYWRkUG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2FkZCcpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFyUG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2F2YXRhcicpO1xyXG5leHBvcnQgY29uc3QgZGVsZXRlUG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2RlbGV0ZScpO1xyXG5cclxuLy9pbnB1dHNcclxuZXhwb3J0IGNvbnN0IG5hbWVJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibmFtZVwiKTtcclxuZXhwb3J0IGNvbnN0IGpvYklucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYXRlZ29yeVwiKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhcklucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhdmF0YXJcIik7XHJcblxyXG4vLyBpbWFnZSBmb3JtIGNvbnN0c1xyXG5leHBvcnQgY29uc3QgYnV0dG9uQWRkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgY2xvc2VBZGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFkZF9fY2xvc2VcIik7XHJcbmV4cG9ydCBjb25zdCBmb3JtQWRkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hZGRcIik7XHJcbmV4cG9ydCBjb25zdCBhZGRGb3JtRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRkRm9ybVwiKTtcclxuZXhwb3J0IGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2J1dHRvblwiKTtcclxuXHJcbi8vdmFsaWRhdGlvbiBjb25zdHNcclxuXHJcbmV4cG9ydCBjb25zdCBmb3JtQ29uZmlnID0ge1xyXG4gICAgZm9ybVNlbGVjdG9yOiBcIi5mb3JtXCIsXHJcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5mb3JtX19pbnB1dFwiLFxyXG4gICAgZmllbGRzZXRTZWxlY3RvcjogXCIuZm9ybV9fZmllbGRzZXRcIixcclxuICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19idXR0b25cIixcclxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwiZm9ybV9fYnV0dG9uX2luYWN0aXZlXCIsXHJcbiAgICBpbnB1dEVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gICAgZXJyb3JDbGFzczogXCJmb3JtX19pbnB1dC1lcnJvcl9hY3RpdmVcIixcclxuICB9OyIsImNvbnN0IGZldGNoZXIgPSAodXJsLCBoZWFkZXIpID0+IFxyXG4gICAgZmV0Y2godXJsLCBoZWFkZXIpLnRoZW4oKHJlcykgPT5cclxuICAgIHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChgU29tZXRoaW5nIHdlbnQgd3Jvbmc6ICR7cmVzLnN0YXR1c31gKVxyXG4gICAgICApOyBcclxuXHJcbiAgZXhwb3J0IGNsYXNzIEFwaSB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7YmFzZVVybCwgaGVhZGVyc30pe1xyXG4gICAgICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gICAgfTtcclxuXHJcbiAgICBnZXRVc2VySW5mbygpe1xyXG4gICAgICAgIHJldHVybiBmZXRjaGVyKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBlZGl0UHJvZmlsZShkYXRhKXtcclxuICAgICAgICByZXR1cm4gZmV0Y2hlciAoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBhYm91dDogZGF0YS5kZXNjcmlwdGlvblxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuICAgIGVkaXRQcm9maWxlUGljKGRhdGEpe1xyXG4gICAgICAgIHJldHVybiBmZXRjaGVyIChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBhdmF0YXI6IGRhdGEucGljdHVyZVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBnZXRJbml0aWFsQ2FyZHMoKXtcclxuICAgICAgICByZXR1cm4gZmV0Y2hlcihgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbiAgICByZW5kZXJDYXJkKGRhdGEpe1xyXG4gICAgICAgIHJldHVybiBmZXRjaGVyIChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS50aXRsZSxcclxuICAgICAgICAgICAgICAgIGxpbms6IGRhdGEubGlua1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgbGlrZUNhcmQoaWQpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2hlcihgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2lkfWAsIHtcclxuICAgICAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIFxyXG4gICAgdW5saWtlQ2FyZChpZCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaGVyKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7aWR9YCwge1xyXG4gICAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgXHJcbiAgICBkZWxldGVDYXJkKGlkKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoZXIoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH1gLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuICAgIFxyXG4gIH1cclxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHsgU2VjdGlvbiB9IGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgeyBDYXJkIH0gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgeyBQb3B1cEZvcm0gfSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwRm9ybS5qc1wiO1xyXG5cclxuaW1wb3J0IHsgUG9wdXBJbWFnZSB9IGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBJbWFnZS5qc1wiO1xyXG5cclxuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcblxyXG5pbXBvcnQgeyBQb3B1cERlbGV0ZSB9IGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBEZWxldGUuanNcIjtcclxuXHJcbmltcG9ydCB7XHJcbiAgZm9ybUNvbmZpZyxcclxuICBmb3JtQWRkLFxyXG4gIGZvcm1FZGl0LFxyXG4gIGZvcm1BdmF0YXIsXHJcbiAgYWRkUG9wdXBFbGVtZW50LFxyXG4gIGVkaXRQb3B1cEVsZW1lbnQsXHJcbiAgYXZhdGFyUG9wdXBFbGVtZW50LFxyXG4gIGRlbGV0ZVBvcHVwRWxlbWVudCxcclxuICBidXR0b25BZGQsXHJcbiAgYnV0dG9uRWRpdCxcclxuICBuYW1lSW5wdXQsXHJcbiAgam9iSW5wdXQsXHJcbiAgcG9wdXBJbWFnZSxcclxuICBhdmF0YXJJbnB1dCxcclxuICBwcm9maWxlUGljLFxyXG59IGZyb20gXCIuLi9zY3JpcHRzL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5cclxuaW1wb3J0IHsgQXBpIH0gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9BcGkuanNcIjtcclxuXHJcbi8vaW5pdGlhbGl6aW5nIGFwaVxyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2NvaG9ydC0zLWVuXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCJiNDUxMjk0Yi00NGQ5LTQ2NGEtODg3NC0yZDQxMzdhNGViM2NcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgfVxyXG59KTtcclxuXHJcbmxldCB1c2VySWQ7XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgZnVsbE5hbWU6IFwiLnByb2ZpbGVfX25hbWVcIixcclxuICBjYXRlZ29yeTogXCIucHJvZmlsZV9fY2F0ZWdvcnlcIixcclxuICBwcm9maWxlUGljOiBcIi5wcm9maWxlX19waWN0dXJlXCJcclxufSk7XHJcblxyXG4vL2dldHRpbmcgaW5pdGlhbCBjYXJkcyBhbmQgcHJvZmlsZSBpbmZvXHJcblxyXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pXHJcbiAgLnRoZW4oKFt1c2VyRGF0YSwgaXRlbXNdKSA9PiB7XHJcbiAgICB1c2VySWQgPSB1c2VyRGF0YS5pZDtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhLm5hbWUsIHVzZXJEYXRhLmFib3V0KTtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbWFnZSh1c2VyRGF0YS5hdmF0YXIpO1xyXG5cclxuICAgIGNhcmRMaXN0LnJlbmRlckl0ZW1zKGl0ZW1zKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7Y29uc29sZS5sb2coZXJyKX0pXHJcblxyXG4vL3N1Ym1pdHRpbmcgY2FyZFxyXG5cclxuY29uc3Qgc3VibWl0Q2FyZCA9IChkYXRhKSA9PiB7XHJcbiAgYXBpLnJlbmRlckNhcmQoZGF0YS50aXRsZSwgZGF0YS5saW5rKVxyXG4gIC50aGVuKChyZXMpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKCdyZXMgPT4gJywgcmVzKVxyXG4gICAgY29uc3QgbmV3SW1hZ2UgPSB7XHJcbiAgICAgIG5hbWU6IHJlcy5uYW1lLFxyXG4gICAgICBsaW5rOiByZXMubGluayxcclxuICAgICAgbGlrZXM6IHJlcy5saWtlcyxcclxuICAgICAgX2lkOiByZXMuX2lkXHJcbiAgICB9O1xyXG4gICAgY2FyZExpc3QuYWRkSXRlbShuZXdJbWFnZSk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4geyBjb25zb2xlLmxvZyhlcnIpfSlcclxuICAuZmluYWxseSggKCkgPT4geyBjYXJkRm9ybS5jbG9zZSgpO30pXHJcblxyXG5cclxufVxyXG5cclxuLy9zdWJtaXR0aW5nIHByb2ZpbGVcclxuXHJcbmNvbnN0IHN1Ym1pdFByb2ZpbGUgPSAoZGF0YSkgPT4ge1xyXG4gIGFwaS5lZGl0UHJvZmlsZShkYXRhLm5hbWUsIGRhdGEuZGVzY3JpcHRpb24pXHJcbiAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgXHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMubmFtZSwgZGF0YS5kZXNjcmlwdGlvbilcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7IGNvbnNvbGUubG9nKGVycil9KVxyXG4gIC5maW5hbGx5KCAoKSA9PiB7XHJcbiAgICBwcm9maWxlRm9ybS5jbG9zZSgpO1xyXG4gIH0pXHJcbn1cclxuXHJcbi8vc3VibWl0dGluZyBwcm9maWxlIHBpY1xyXG5cclxuY29uc3Qgc3VibWl0QXZhdGFyID0gKGRhdGEpID0+IHtcclxuICBhcGkuZWRpdFByb2ZpbGVQaWMoZGF0YS5waWN0dXJlKVxyXG4gIC50aGVuKChyZXMpID0+IHtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbWFnZShyZXMucGljdHVyZSlcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7IGNvbnNvbGUubG9nKGVycil9KVxyXG4gIC5maW5hbGx5KCAoKSA9PiB7IGF2YXRhckZvcm0uY2xvc2UoKX0pXHJcblxyXG59XHJcblxyXG4vL2Rpc3BsYXlpbmcgY2FyZHMgaW4gZ2FsbGVyeVxyXG5cclxuY29uc3QgY2FyZExpc3QgPSBuZXcgU2VjdGlvbihcclxuICB7XHJcbiAgICAvL2l0ZW1zOiBpbml0aWFsQ2FyZHMsXHJcbiAgICByZW5kZXJlcjogcmVuZGVyQ2FyZCxcclxuICB9LFxyXG4gIFwiLmdyaWRfX2NhcmRzXCJcclxuKTtcclxuXHJcbi8vY2FyZExpc3QucmVuZGVySXRlbXMoKTtcclxuXHJcbi8vdXNlciBpbmZvIHNlY3Rpb25cclxuXHJcbmNvbnN0IHByb2ZpbGVGb3JtID0gbmV3IFBvcHVwRm9ybShlZGl0UG9wdXBFbGVtZW50LCBzdWJtaXRQcm9maWxlKVxyXG5wcm9maWxlRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy9jYXJkIHNlY3Rpb25cclxuXHJcbmNvbnN0IGNhcmRGb3JtID0gbmV3IFBvcHVwRm9ybShhZGRQb3B1cEVsZW1lbnQsIHN1Ym1pdENhcmQpXHJcbmNhcmRGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL2ltYWdlIHNlY3Rpb25cclxuXHJcbmNvbnN0IGltYWdlTW9kdWxlID0gbmV3IFBvcHVwSW1hZ2UocG9wdXBJbWFnZSk7XHJcbmltYWdlTW9kdWxlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL2F2YXRhciBzZWN0aW9uXHJcblxyXG5jb25zdCBhdmF0YXJGb3JtID0gbmV3IFBvcHVwRm9ybShhdmF0YXJQb3B1cEVsZW1lbnQsIHN1Ym1pdEF2YXRhcik7XHJcbmF2YXRhckZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vZGVsZXRlIHNlY3Rpb25cclxuXHJcbmNvbnN0IGRlbGV0ZUZvcm0gPSBuZXcgUG9wdXBEZWxldGUoZGVsZXRlUG9wdXBFbGVtZW50KTtcclxuZGVsZXRlRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuXHJcbi8vYWRkaW5nIGNhcmQgdG8gZ2FsbGVyeVxyXG5cclxuZnVuY3Rpb24gcmVuZGVyQ2FyZChjYXJkKSB7XHJcbiAgY29uc3QgaW1hZ2UgPSBuZXcgQ2FyZChjYXJkLCBcclxuICAgIHVzZXJJZCxcclxuICAgIFwiI2NhcmRcIixcclxuICAgICAoKSA9PiB7XHJcbiAgICBpbWFnZU1vZHVsZS5vcGVuKGNhcmQudGl0bGUsIGNhcmQubGluayk7IC8vaGFuZGxlQ2FyZENsaWNrXHJcbiAgfSxcclxuICAoKSA9PiB7XHJcbiAgICBpZiAoaW1hZ2UuaXNMaWtlZCgpKXtcclxuICAgICAgYXBpLnVubGlrZUNhcmQoY2FyZC5nZXRJZCgpKVxyXG4gICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgIGNhcmQuZ2V0TGlrZXMocmVzLm51bWJlcilcclxuICAgICAgfSlcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICBhcGkubGlrZUNhcmQoY2FyZC5nZXRJZCgpKVxyXG4gICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgIGNhcmQuZ2V0TGlrZXMocmVzLm51bWJlcilcclxuICAgIH0pXHJcbiAgfVxyXG59LCAoKSA9PiB7XHJcbiAgZGVsZXRlRm9ybS5vcGVuKCk7XHJcbiAgZGVsZXRlRm9ybS5zdWJtaXREZWxldGUoKCkgPT4ge1xyXG4gICAgYXBpLmRlbGV0ZUNhcmQoaWQpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIGltYWdlLmRlbGV0ZUNhcmQoKTtcclxuICAgICAgZGVsZXRlRm9ybS5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7IGNvbnNvbGUubG9nKGVycil9KVxyXG4gIC5maW5hbGx5KCAoKSA9PiB7IGRlbGV0ZUZvcm0uY2xvc2UoKX0pXHJcbiAgfSlcclxufVxyXG4gICk7XHJcbiAgcmV0dXJuIGltYWdlLmdlbmVyYXRlQ2FyZCgpO1xyXG59XHJcblxyXG5cclxuLy9nZXR0aW5nIHRoZSBjdXJyZW50IHVzZXIgaW5mb1xyXG5cclxuXHJcblxyXG5mdW5jdGlvbiByZW5kZXJQcm9maWxlKCl7XHJcbiAgY29uc3QgcHJvZmlsZSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcblxyXG4gIG5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGUubmFtZVxyXG4gIGpvYklucHV0LnZhbHVlID0gcHJvZmlsZS5kZXNjcmlwdGlvbjtcclxuICBcclxuICBlZGl0Rm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb25FcnJvcigpO1xyXG4gIHByb2ZpbGVGb3JtLm9wZW4oKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVuZGVyQXZhdGFyKCl7XHJcbiAgY29uc3QgcHJvZmlsZSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgYXZhdGFySW5wdXQudmFsdWUgPSBwcm9maWxlLnBpY3R1cmU7XHJcblxyXG4gIGF2YXRhckZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uRXJyb3IoKTtcclxuICBhdmF0YXJGb3JtLm9wZW4oKTtcclxufVxyXG5cclxuXHJcbi8vaGFuZGxlcnNcclxuXHJcbmJ1dHRvbkVkaXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHJlbmRlclByb2ZpbGUpO1xyXG5cclxuYnV0dG9uQWRkLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgYWRkRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb25FcnJvcigpO1xyXG4gIGNhcmRGb3JtLm9wZW4oKTtcclxufSk7XHJcblxyXG5wcm9maWxlUGljLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCByZW5kZXJBdmF0YXIpXHJcblxyXG5cclxuLy92YWxpZGF0b3Igc2V0dGluZ3NcclxuXHJcbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybUNvbmZpZywgZm9ybUVkaXQpO1xyXG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybUNvbmZpZywgZm9ybUFkZCk7XHJcbmNvbnN0IGF2YXRhckZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtQ29uZmlnLCBmb3JtQXZhdGFyKTtcclxuXHJcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmF2YXRhckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpOyIsImV4cG9ydCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7IGZ1bGxOYW1lLCBjYXRlZ29yeSwgcHJvZmlsZVBpYyB9KSB7XHJcbiAgICAgIHRoaXMuX2Z1bGxOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihmdWxsTmFtZSk7XHJcbiAgICAgIHRoaXMuX2NhdGVnb3J5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihjYXRlZ29yeSk7XHJcbiAgICAgIHRoaXMuX3Byb2ZpbGVQaWMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVQaWMpO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgbmFtZTogdGhpcy5fZnVsbE5hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuX2NhdGVnb3J5LnRleHRDb250ZW50LFxyXG4gICAgICAgIHBpY3R1cmU6IHRoaXMuX3Byb2ZpbGVQaWMuc3JjXHJcbiAgICAgIH1cclxuICAgIH1cclxuICBcclxuICAgIHNldFVzZXJJbmZvKCBuYW1lLCBkZXNjcmlwdGlvbiApIHtcclxuICAgICAgdGhpcy5fZnVsbE5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgICB0aGlzLl9jYXRlZ29yeS50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xyXG4gICAgfVxyXG5cclxuICAgIHNldFVzZXJJbWFnZShwaWN0dXJlKXtcclxuICAgICAgdGhpcy5fcHJvZmlsZVBpYy5zcmMgPSBwaWN0dXJlO1xyXG4gICAgfVxyXG5cclxuICB9XHJcbiAgIiwiZXhwb3J0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgcmVuZGVyZXIgfSwgIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgIC8vIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICAvLyBpbnNlcnRzIGVsZW1lbnQgdG8gdGhlIGNvbnRhaW5lclxyXG4gIGFkZEl0ZW0oaXRlbSkge1xyXG4gICAgY29uc3QgZWxlbWVudCA9IHRoaXMuX3JlbmRlcmVyKGl0ZW0pXHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KVxyXG4gIH07XHJcblxyXG4gIC8vIHJlbmRlcnMgaW5pdGlhbCBpdGVtc1xyXG4gIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XHJcbiAgICBpdGVtcy5mb3JFYWNoKChkYXRhKSA9PiB7XHJcbiAgICAgIHRoaXMuYWRkSXRlbShkYXRhKVxyXG4gICAgfSlcclxuICB9O1xyXG59IiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwSW1hZ2UgZXh0ZW5kcyBQb3B1cHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwRWxlbWVudCl7XHJcbiAgICAgICAgc3VwZXIocG9wdXBFbGVtZW50KTtcclxuXHJcbiAgICAgICAgdGhpcy5faW1hZ2VUaXRsZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmltYWdlX190aXRsZVwiKTtcclxuICAgICAgICB0aGlzLl9pbWFnZVByZXZpZXcgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5pbWFnZV9fZmlsZVwiKTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuKHRpdGxlLCBsaW5rKXtcclxuICAgIFxyXG4gICAgICAgIHN1cGVyLm9wZW4oKVxyXG4gICAgdGhpcy5faW1hZ2VQcmV2aWV3LnNyYyA9IGxpbms7XHJcbiAgICB0aGlzLl9pbWFnZVByZXZpZXcuYWx0ID0gdGl0bGU7XHJcbiAgICB0aGlzLl9pbWFnZVRpdGxlLnRleHRDb250ZW50ID0gdGl0bGU7XHJcblxyXG4gXHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBEZWxldGUgZXh0ZW5kcyBQb3B1cHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwRWxlbWVudCl7XHJcbiAgICAgICAgc3VwZXIocG9wdXBFbGVtZW50KVxyXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjc3VibWl0QnV0dG9uXCIpO1xyXG4gICAgICAgIC8vdGhpcy5fY2FuY2VsQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FuY2VsQnV0dG9uXCIpO1xyXG4gICAgICAgIHRoaXMuX3RleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgc3VibWl0RGVsZXRlKGV2dCl7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlU3VibWl0ID0gZXZ0OyBcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpe1xyXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlU3VibWl0KCk7XHJcblxyXG4gICAgICAgIH0pXHJcbiAgICAgICAvLyB0aGlzLl9jYW5jZWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHtcclxuICAgICAgICAgICAgLy90aGlzLl9mb3JtRWxlbWVudC5jbG9zZSgpO1xyXG4gICAgICAgLy8gfSlcclxuICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcbn0iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsInVzZXJJZCIsImNhcmRTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZUxpa2UiLCJoYW5kbGVEZWxldGUiLCJ0aGlzIiwiX2xpa2VzIiwiZmluZCIsInVzZXIiLCJfaWQiLCJfdXNlcklkIiwiX2VsZW1lbnQiLCJyZW1vdmUiLCJfZGF0YSIsIl90aXRsZSIsInRpdGxlIiwiX2xpbmsiLCJsaW5rIiwibGlrZXMiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUxpa2UiLCJfaGFuZGxlRGVsZXRlIiwiX2hhbmRsZUNhcmRDbGljayIsImdldElkIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsImdlbmVyYXRlQ2FyZCIsIl9zZXRFdmVudExpc3RlbmVycyIsImNhcmRJbWFnZSIsImNhcmRUaXRsZSIsInN0eWxlIiwiYmFja2dyb3VuZEltYWdlIiwidGV4dENvbnRlbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZ2V0TGlrZXMiLCJudW1iZXIiLCJfY291bnRMaWtlcyIsImNhcmRMaWtlIiwibGVuZ3RoIiwiaXNMaWtlZCIsImNsYXNzTGlzdCIsInRvZ2dsZSIsImNvbmZpZyIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJhZGQiLCJfaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGFzSW52YWxpZElucHV0IiwiX2lucHV0TGlzdCIsIl9idXR0b25FbGVtZW50IiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJkaXNhYmxlZCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9maWVsZHNldFNlbGVjdG9yIiwiZmllbGRzZXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwicmVzZXRWYWxpZGF0aW9uRXJyb3IiLCJmb3JFYWNoIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwic29tZSIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsImVuYWJsZVZhbGlkYXRpb24iLCJQb3B1cCIsInBvcHVwRWxlbWVudCIsInRhcmdldCIsImN1cnJlbnRUYXJnZXQiLCJjbG9zZSIsIl9wb3B1cEVsZW1lbnQiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwiX2hhbmRsZUxheW92ZXJDbG9zZSIsImtleSIsIm9wZW4iLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJjb250YWlucyIsIlBvcHVwRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2Zvcm1FbGVtZW50IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRzIiwiaW5wdXQiLCJ2YWx1ZSIsImUiLCJzZXRJbnB1dFZhbHVlcyIsIl9pbnB1dHMiLCJuYW1lIiwicmVzZXQiLCJwcm9maWxlUGljIiwicG9wdXBJbWFnZSIsImJ1dHRvbkVkaXQiLCJnZXRFbGVtZW50QnlJZCIsImZvcm1FZGl0IiwiZm9ybUF2YXRhciIsImVkaXRQb3B1cEVsZW1lbnQiLCJhZGRQb3B1cEVsZW1lbnQiLCJhdmF0YXJQb3B1cEVsZW1lbnQiLCJkZWxldGVQb3B1cEVsZW1lbnQiLCJuYW1lSW5wdXQiLCJqb2JJbnB1dCIsImF2YXRhcklucHV0IiwiYnV0dG9uQWRkIiwiZm9ybUFkZCIsImZvcm1Db25maWciLCJmb3JtU2VsZWN0b3IiLCJmZXRjaGVyIiwidXJsIiwiaGVhZGVyIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImdldFVzZXJJbmZvIiwiZWRpdFByb2ZpbGUiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFib3V0IiwiZGVzY3JpcHRpb24iLCJlZGl0UHJvZmlsZVBpYyIsImF2YXRhciIsInBpY3R1cmUiLCJnZXRJbml0aWFsQ2FyZHMiLCJyZW5kZXJDYXJkIiwibGlrZUNhcmQiLCJ1bmxpa2VDYXJkIiwiZGVsZXRlQ2FyZCIsImF1dGhvcml6YXRpb24iLCJ1c2VySW5mbyIsImZ1bGxOYW1lIiwiY2F0ZWdvcnkiLCJfZnVsbE5hbWUiLCJfY2F0ZWdvcnkiLCJfcHJvZmlsZVBpYyIsInNyYyIsInNldFVzZXJJbmZvIiwic2V0VXNlckltYWdlIiwiYWxsIiwidXNlckRhdGEiLCJpdGVtcyIsImNhcmRMaXN0IiwicmVuZGVySXRlbXMiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJjb250YWluZXJTZWxlY3RvciIsInJlbmRlcmVyIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImFkZEl0ZW0iLCJpdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJjYXJkIiwiaW1hZ2UiLCJpbWFnZU1vZHVsZSIsImRlbGV0ZUZvcm0iLCJzdWJtaXREZWxldGUiLCJmaW5hbGx5IiwicHJvZmlsZUZvcm0iLCJjYXJkRm9ybSIsIm5ld0ltYWdlIiwiX2ltYWdlVGl0bGUiLCJfaW1hZ2VQcmV2aWV3IiwiYWx0IiwiYXZhdGFyRm9ybSIsIl9zdWJtaXRCdXR0b24iLCJfdGV4dCIsIl9oYW5kbGVTdWJtaXQiLCJwcm9maWxlIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJhZGRGb3JtVmFsaWRhdG9yIiwiYXZhdGFyRm9ybVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiXSwic291cmNlUm9vdCI6IiJ9