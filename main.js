!function(){"use strict";function e(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class t{constructor(t,s,r,i,n,o){e(this,"isLiked",(()=>this._likes.some((e=>e._id===this._userId)))),e(this,"deleteCard",(()=>{this._element.remove(),this._element=null})),this._data=t,this._name=t.name,this._link=t.link,this._likes=t.likes,this._id=t._id,this._userId=s,this._cardSelector=r,this._handleLike=n,this._handleDelete=o,this._handleCardClick=i}getId(){return this._id}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".grid__card").cloneNode(!0)}generateCard(){this._element=this._getTemplate(),this._setEventListeners();const e=this._element.querySelector(".card__image"),t=this._element.querySelector(".card__title");return e.style.backgroundImage="url(".concat(this._link,")"),t.textContent=this._name,this._renderLikes(),this._element}_setEventListeners(){this._element.querySelector(".card__like-button").addEventListener("click",(()=>this._handleLike(this._id))),this._element.querySelector(".card__delete").addEventListener("click",(()=>this._handleDelete(this._id))),this._element.querySelector(".card__image").addEventListener("click",(()=>{this._handleCardClick()}))}setLikes(e){this._likes=e,this._renderLikes()}_renderLikes(){const e=this._element.querySelector(".card__like-button");this._element.querySelector(".card__like-counter").textContent=this._likes.length,this.isLiked()?e.classList.add("card__like_active"):e.classList.remove("card__like_active")}}function s(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var r=class{constructor(e,t){s(this,"_showInputError",((e,t)=>{const s=this._element.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)})),s(this,"_hideInputError",(e=>{const t=this._element.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.classList.remove(this._inputErrorClass),t.textContent=""})),s(this,"_checkInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)})),s(this,"_toggleButtonState",(()=>{this._hasInvalidInput(this._inputList)?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)})),this._inputSelector=e.inputSelector,this._fieldsetSelector=e.fieldsetSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._element=t,this._inputList=Array.from(t.querySelectorAll(this._inputSelector)),this._buttonElement=t.querySelector(this._submitButtonSelector)}resetValidationError(){this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_setEventListeners(){this._element.addEventListener("submit",(function(e){e.preventDefault()})),this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._element.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}};class i{constructor(e){var t,s;s=e=>{e.target===e.currentTarget&&this.close(e.target)},(t="_handleLayoverClose")in this?Object.defineProperty(this,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[t]=s,this._popupElement=e,this._handleEscClose=this._handleEscClose.bind(this),this._handleLayoverClose=this._handleLayoverClose.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}open(){this._popupElement.classList.add("popup_enabled"),document.addEventListener("keydown",this._handleEscClose),this._popupElement.addEventListener("mousedown",this._handleLayoverClose)}close(){this._popupElement.classList.remove("popup_enabled"),document.removeEventListener("keydown",this._handleEscClose),this._popupElement.removeEventListener("mousedown",this._handleLayoverClose)}setEventListeners(){this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("popup__close")&&this.close()}))}}class n extends i{constructor(e,t){let{handleFormSubmit:s,buttonText:r,loadingButtonText:i}=t;super(e),this._handleFormSubmit=s,this._formElement=this._popupElement.querySelector(".popup__form"),this._inputList=this._formElement.querySelectorAll(".form__input"),this._loadingButtonText=i,this._submitButton=this._formElement.querySelector(".form__button")}_getInputValues(){const e={};return this._inputList.forEach((t=>{const s=t.id,r=t.value;e[s]=r})),e}setEventListeners(){super.setEventListeners(),this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}showLoading(){this._submitButton.textContent="Loading..."}hideLoading(){this._submitButton.textContent="Save"}setInputValues(e){this._inputs.forEach((t=>{t.value=e[t.name]}))}close(){super.close(),this._formElement.reset()}}document.querySelector(".profile__name"),document.querySelector(".profile__category"),document.querySelector(".profile__picture");const o=document.querySelector(".profile__picture-overlay"),l=document.querySelector(".image"),a=(document.getElementById("title"),document.getElementById("link"),document.querySelector(".grid__cards"),document.querySelector(".profile__edit-button")),c=(document.querySelector(".edit__close"),document.querySelector(".edit")),d=(document.getElementById("editForm"),document.querySelector(".avatar")),u=document.querySelector("#edit"),h=document.querySelector("#add"),_=document.querySelector("#avatar"),m=document.querySelector("#delete"),p=document.getElementById("name"),f=document.getElementById("category"),E=document.getElementById("avatarInput"),g=document.querySelector(".profile__add-button"),y=(document.querySelector(".add__close"),document.querySelector(".add")),v=(document.getElementById("addForm"),document.querySelector(".form__button"),{formSelector:".form",inputSelector:".form__input",fieldsetSelector:".form__fieldset",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_inactive",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"}),b=new class{constructor(e){let{baseUrl:t,headers:s}=e;var r,i;i=(e,t)=>fetch(e,t).then((e=>e.ok?e.json():Promise.reject("Something went wrong: ".concat(e.status)))),(r="fetcher")in this?Object.defineProperty(this,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[r]=i,this._baseUrl=t,this._headers=s}getUserInfo(){return fetcher("".concat(this._baseUrl,"/users/me"),{headers:this._headers})}editProfile(e){return fetcher("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.description})})}editProfilePic(e){return fetcher("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.picture})})}getInitialCards(){return fetcher("".concat(this._baseUrl,"/cards"),{headers:this._headers})}createCard(e){return fetcher("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.title,link:e.link})})}likeCard(e){return fetcher("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers})}unlikeCard(e){return fetcher("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers})}deleteCard(e){return fetcher("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers})}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"b451294b-44d9-464a-8874-2d4137a4eb3c","Content-Type":"application/json"}});let L;const S=new class{constructor(e){let{fullName:t,category:s,profilePic:r}=e;this._fullName=document.querySelector(t),this._category=document.querySelector(s),this._profilePic=document.querySelector(r)}getUserInfo(){return{name:this._fullName.textContent,description:this._category.textContent,picture:this._profilePic.src}}setUserInfo(e,t){this._fullName.textContent=e,this._category.textContent=t}setUserImage(e){this._profilePic.src=e}}({fullName:".profile__name",category:".profile__category",profilePic:".profile__picture"});Promise.all([b.getUserInfo(),b.getInitialCards()]).then((e=>{let[t,s]=e;L=t.id,S.setUserInfo(t.name,t.about),S.setUserImage(t.avatar),C.renderItems(s)})).catch((e=>{console.log(e)}));const C=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}addItem(e){const t=this._renderer(e);this._container.prepend(t)}renderItems(e){e.forEach((e=>{this.addItem(e)}))}}({renderer:P},".grid__cards"),k=new n(u,(e=>{k.showLoading(),b.editProfile(e.name,e.description).then((t=>{S.setUserInfo(t.name,e.description)})).catch((e=>{console.log(e)})).finally((()=>{k.hideLoading()}))}));k.setEventListeners();const I=new n(h,(e=>{I.showLoading(),b.createCard(e).then((e=>{const t=P(e);C.prepend(t),I.close(),y.reset(),y.resetValidationError()})).catch((e=>{console.log(e)})).finally((()=>{I.hideLoading()}))}));I.setEventListeners();const q=new class extends i{constructor(e){super(e),this._imageTitle=this._popupElement.querySelector(".image__title"),this._imagePreview=this._popupElement.querySelector(".image__file")}open(e,t){super.open(),this._imagePreview.src=t,this._imagePreview.alt=e,this._imageTitle.textContent=e}}(l);q.setEventListeners();const w=new n(_,(e=>{w.showLoading(),b.editProfilePic(e.picture).then((e=>{S.setUserImage(e.picture)})).catch((e=>{console.log(e)})).finally((()=>{w.hideLoading()}))}));w.setEventListeners();const B=new class extends i{constructor(e){super(e),this._formElement=this._popupElement.querySelector(".popup__form"),this._submitButton=this._popupElement.querySelector("#submitButton"),this._text=this._submitButton.textContent}setAction(e){this._handleSubmit=e}setEventListeners(){this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()})),super.setEventListeners()}}(m);function P(e){const s=new t(e,L,"#card",(()=>{q.open(e.name,e.link)}),(()=>{s.isLiked()?b.unlikeCard(s.getId()).then((t=>{e.setLikes(t.likes)})):b.likeCard(s.getId()).then((t=>{e.setLikes(t.likes)}))}),(()=>{B.open(),B.setAction((()=>{b.deleteCard(s.getId()).then((()=>{s.deleteCard(),B.close()})).catch((e=>{console.log(e)})).finally((()=>{B.close()}))}))}));return s.generateCard()}B.setEventListeners(),a.addEventListener("click",(function(){const e=S.getUserInfo();p.value=e.name,f.value=e.description,U.resetValidationError(),k.open()})),g.addEventListener("click",(()=>{x.resetValidationError(),I.open()})),o.addEventListener("click",(function(){const e=S.getUserInfo();E.value=e.picture,T.resetValidationError(),w.open()}));const U=new r(v,c),x=new r(v,y),T=new r(v,d);U.enableValidation(),x.enableValidation(),T.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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U29HLEVBQUl4SCxVQUlwQmlILEVBQUk4QixTQUFTOEMsRUFBTXhMLFNBQ2xCa0gsTUFBS0MsSUFDSjNJLEVBQUt1QyxTQUFTb0csRUFBSXhILGFBR3ZCLEtBQ0R3TCxFQUFXL0csT0FDWCtHLEVBQVdFLFdBQVUsS0FDbkJ6RSxFQUFJZ0MsV0FBVzRDLEVBQU14TCxTQUNwQmtILE1BQUssS0FDSnNFLEVBQU01QyxhQUNOdUMsRUFBV3JILFdBRVo4RixPQUFPQyxJQUFVQyxRQUFRQyxJQUFJRixNQUMvQmEsU0FBUyxLQUFRUyxFQUFXckgsaUJBSTdCLE9BQU8wSCxFQUFNbEwsZUF0Q2Y2SyxFQUFXN0csb0JBbUVYdUIsRUFBVy9FLGlCQUFpQixTQXJCNUIsV0FDRSxNQUFNMkssRUFBVTNDLEVBQVNuQixjQUV6QnRCLEVBQVVqQixNQUFRcUcsRUFBUWpNLEtBQzFCOEcsRUFBU2xCLE1BQVFxRyxFQUFRdEQsWUFFekJ1RCxFQUFrQnZJLHVCQUNsQnNILEVBQVlyRyxVQWdCZG9DLEVBQVUxRixpQkFBaUIsU0FBUyxLQUNsQzZLLEVBQWlCeEksdUJBQ2pCd0gsRUFBU3ZHLFVBR1h1QixFQUFjN0UsaUJBQWlCLFNBbEIvQixXQUNFLE1BQU0ySyxFQUFVM0MsRUFBU25CLGNBQ3pCcEIsRUFBWW5CLE1BQVFxRyxFQUFRbkQsUUFFNUJzRCxFQUFvQnpJLHVCQUNwQitILEVBQVc5RyxVQWtCYixNQUFNc0gsRUFBb0IsSUFBSUcsRUFBY25GLEVBQVlYLEdBQ2xENEYsRUFBbUIsSUFBSUUsRUFBY25GLEVBQVlELEdBQ2pEbUYsRUFBc0IsSUFBSUMsRUFBY25GLEVBQVlWLEdBRTFEMEYsRUFBa0JqSSxtQkFDbEJrSSxFQUFpQmxJLG1CQUNqQm1JLEVBQW9CbkksbUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3Byb2plY3RfNC8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cERlbGV0ZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcclxuXHJcblxyXG5leHBvcnQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoZGF0YSwgdXNlcklkLCBjYXJkU2VsZWN0b3IsIGhhbmRsZUNhcmRDbGljaywgaGFuZGxlTGlrZSwgaGFuZGxlRGVsZXRlKSB7XHJcbiAgICB0aGlzLl9kYXRhID0gZGF0YTtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xyXG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcclxuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUxpa2UgPSBoYW5kbGVMaWtlO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlID0gaGFuZGxlRGVsZXRlO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gIH1cclxuXHJcbiAgZ2V0SWQoKXtcclxuICAgIHJldHVybiB0aGlzLl9pZDtcclxuICB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5ncmlkX19jYXJkXCIpO1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICBjb25zdCBjYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICBjb25zdCBjYXJkVGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcblxyXG4gICAgY2FyZEltYWdlLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHt0aGlzLl9saW5rfSlgO1xyXG4gICAgY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuXHJcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy9saWtlIGhhbmRsZXJcclxuICAgIGNvbnN0IGNhcmRMaWtlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgY2FyZExpa2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZUxpa2UodGhpcy5faWQpKTtcclxuXHJcblxyXG4gICAgLy9kZWxldGUgaGFuZGxlclxyXG4gICAgY29uc3QgY2FyZERlbGV0ZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGVcIik7XHJcbiAgICBjYXJkRGVsZXRlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAgKCkgPT4gdGhpcy5faGFuZGxlRGVsZXRlKHRoaXMuX2lkKSk7XHJcblxyXG4gICAgLy9pbWFnZSBjbGljayBoYW5kbGVyXHJcbiAgICBjb25zdCBjYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICBjYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHsgdGhpcy5faGFuZGxlQ2FyZENsaWNrKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGlzTGlrZWQgPSAoKSA9PiB7XHJcbiAgICByZXR1cm4gdGhpcy5fbGlrZXMuc29tZSh1c2VyID0+IHVzZXIuX2lkID09PSB0aGlzLl91c2VySWQpO1xyXG4gIH1cclxuXHJcbiAgc2V0TGlrZXMobGlrZXMpe1xyXG4gICAgdGhpcy5fbGlrZXMgPSBsaWtlcztcclxuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XHJcbiAgfVxyXG5cclxuICBfcmVuZGVyTGlrZXMoKXtcclxuICAgIGNvbnN0IGNhcmRMaWtlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgY29uc3QgY2FyZExpa2VDb3VudGVyID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtY291bnRlclwiKTtcclxuICAgIGNhcmRMaWtlQ291bnRlci50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcclxuXHJcbiAgICBpZiAodGhpcy5pc0xpa2VkKCkpIHsgXHJcbiAgICAgIGNhcmRMaWtlLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlX2FjdGl2ZVwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNhcmRMaWtlLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlX2FjdGl2ZVwiKTtcclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICAvL19oYW5kbGVDYXJkQ2xpY2sgPSAoKSA9PiB7XHJcbiAgIC8vIHRoaXMuUG9wdXBJbWFnZVxyXG4gLy8gfVxyXG5cclxuICAvL19wcmVzc0xpa2UgPSAoZXZ0KSA9PiB7XHJcbiAgICAvL2V2dC50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2VfYWN0aXZlXCIpO1xyXG4gIC8vfTtcclxuXHJcbiAgZGVsZXRlQ2FyZCA9ICgpID0+IHtcclxuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcclxuICB9O1xyXG59IiwiY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGNvbmZpZy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fZmllbGRzZXRTZWxlY3RvciA9IGNvbmZpZy5maWVsZHNldFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBjb25maWcuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IGNvbmZpZy5lcnJvckNsYXNzO1xyXG5cclxuICAgIHRoaXMuX2VsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IgPSAoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpID0+IHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH07XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvciA9IChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gIH07XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbkVycm9yKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkgPSAoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlID0gKCkgPT4ge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dExpc3QpKSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZnVuY3Rpb24gKGV2dCkge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGZ1bmN0aW9uIChldnQpIHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjsiLCJleHBvcnQgY2xhc3MgUG9wdXB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBFbGVtZW50KXtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IHBvcHVwRWxlbWVudDtcclxuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcclxuICAgIHRoaXMuX2hhbmRsZUxheW92ZXJDbG9zZSA9IHRoaXMuX2hhbmRsZUxheW92ZXJDbG9zZS5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xyXG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlTGF5b3ZlckNsb3NlID0gKGV2dCkgPT4ge1xyXG4gICAgaWYgKGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0KSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoZXZ0LnRhcmdldCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfZW5hYmxlZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZUxheW92ZXJDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfZW5hYmxlZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZUxheW92ZXJDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9fY2xvc2VcIikpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICB9KTtcclxuXHJcblxyXG59XHJcbn0iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwRWxlbWVudCwge2hhbmRsZUZvcm1TdWJtaXQsIGJ1dHRvblRleHQsIGxvYWRpbmdCdXR0b25UZXh0IH0pIHtcclxuICAgIHN1cGVyKHBvcHVwRWxlbWVudCk7XHJcblxyXG5cclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybV9faW5wdXRcIik7XHJcbiAgICB0aGlzLl9sb2FkaW5nQnV0dG9uVGV4dCA9IGxvYWRpbmdCdXR0b25UZXh0O1xyXG4gICAgLy90aGlzLl9idXR0b25UZXh0ID0gYnV0dG9uVGV4dDtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fYnV0dG9uXCIpO1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgaW5wdXRzID0ge307XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGNvbnN0IGtleSA9IGlucHV0LmlkO1xyXG4gICAgICBjb25zdCB2YWx1ZSA9IGlucHV0LnZhbHVlO1xyXG4gICAgICBpbnB1dHNba2V5XSA9IHZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gaW5wdXRzO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzaG93TG9hZGluZygpe1xyXG4gICAgY29uc3Qgc3VibWl0ID0gdGhpcy5fc3VibWl0QnV0dG9uO1xyXG5cclxuICAgIHN1Ym1pdC50ZXh0Q29udGVudCA9IFwiTG9hZGluZy4uLlwiO1xyXG4gIH1cclxuXHJcbiAgaGlkZUxvYWRpbmcoKXtcclxuICAgIGNvbnN0IHN1Ym1pdCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbjtcclxuXHJcbiAgICBzdWJtaXQudGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcclxuICB9XHJcblxyXG4gIHNldElucHV0VmFsdWVzKGRhdGEpIHtcclxuICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dC52YWx1ZSA9IGRhdGFbaW5wdXQubmFtZV07XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKVxyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQucmVzZXQoKVxyXG59XHJcblxyXG59IiwiLy9pbml0aWFsIGltYWdlc1xyXG5cclxuZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICAgIHtcclxuICAgICAgdGl0bGU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCIsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICB0aXRsZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgdGl0bGU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9iYWxkLW1vdW50YWlucy5qcGdcIixcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIHRpdGxlOiBcIkxhdGVtYXJcIixcclxuICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgdGl0bGU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvdmFub2lzZS5qcGdcIixcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIHRpdGxlOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFnby5qcGdcIixcclxuICAgIH0sXHJcbiAgXTtcclxuICBcclxuLy9wcm9maWxlIGNvbnN0c1xyXG5cclxuZXhwb3J0IGNvbnN0IGZ1bGxOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xyXG5leHBvcnQgY29uc3QgY2F0ZWdvcnkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2NhdGVnb3J5XCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZVBpYyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fcGljdHVyZVwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVQaWNCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3BpY3R1cmUtb3ZlcmxheVwiKTtcclxuXHJcbi8vaW1hZ2UgY29uc3RzXHJcbmV4cG9ydCBjb25zdCBwb3B1cEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5pbWFnZVwiKTtcclxuZXhwb3J0IGNvbnN0IHRpdGxlSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRpdGxlXCIpO1xyXG5leHBvcnQgY29uc3QgbGlua0lucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJsaW5rXCIpO1xyXG5cclxuXHJcbmV4cG9ydCBjb25zdCBjYXJkR3JpZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ3JpZF9fY2FyZHNcIik7XHJcblxyXG4vL3Byb2ZpbGUgZm9ybSBjb25zdHNcclxuXHJcbmV4cG9ydCBjb25zdCBidXR0b25FZGl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcclxuZXhwb3J0IGNvbnN0IGNsb3NlRWRpdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdF9fY2xvc2VcIik7XHJcbmV4cG9ydCBjb25zdCBmb3JtRWRpdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdFwiKTtcclxuZXhwb3J0IGNvbnN0IGVkaXRGb3JtRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWRpdEZvcm1cIik7XHJcblxyXG4vL2F2YXRhciBmb3JtIGNvbnN0c1xyXG5cclxuZXhwb3J0IGNvbnN0IGZvcm1BdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmF2YXRhclwiKTtcclxuXHJcbi8vZGVsZXRlIGZvcm0gY29uc3RzXHJcblxyXG5cclxuXHJcbi8vcG9wdXAgZm9ybSBjb25zdHNcclxuXHJcbmV4cG9ydCBjb25zdCBlZGl0UG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2VkaXQnKTtcclxuZXhwb3J0IGNvbnN0IGFkZFBvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhZGQnKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhclBvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhdmF0YXInKTtcclxuZXhwb3J0IGNvbnN0IGRlbGV0ZVBvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNkZWxldGUnKTtcclxuXHJcbi8vaW5wdXRzXHJcbmV4cG9ydCBjb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5hbWVcIik7XHJcbmV4cG9ydCBjb25zdCBqb2JJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2F0ZWdvcnlcIik7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYXZhdGFySW5wdXRcIik7XHJcblxyXG4vLyBpbWFnZSBmb3JtIGNvbnN0c1xyXG5leHBvcnQgY29uc3QgYnV0dG9uQWRkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgY2xvc2VBZGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFkZF9fY2xvc2VcIik7XHJcbmV4cG9ydCBjb25zdCBmb3JtQWRkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hZGRcIik7XHJcbmV4cG9ydCBjb25zdCBhZGRGb3JtRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRkRm9ybVwiKTtcclxuZXhwb3J0IGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2J1dHRvblwiKTtcclxuXHJcbi8vdmFsaWRhdGlvbiBjb25zdHNcclxuXHJcbmV4cG9ydCBjb25zdCBmb3JtQ29uZmlnID0ge1xyXG4gICAgZm9ybVNlbGVjdG9yOiBcIi5mb3JtXCIsXHJcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5mb3JtX19pbnB1dFwiLFxyXG4gICAgZmllbGRzZXRTZWxlY3RvcjogXCIuZm9ybV9fZmllbGRzZXRcIixcclxuICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19idXR0b25cIixcclxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwiZm9ybV9fYnV0dG9uX2luYWN0aXZlXCIsXHJcbiAgICBpbnB1dEVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gICAgZXJyb3JDbGFzczogXCJmb3JtX19pbnB1dC1lcnJvcl9hY3RpdmVcIixcclxuICB9OyIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCB7IFNlY3Rpb24gfSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IHsgQ2FyZCB9IGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IHsgUG9wdXBGb3JtIH0gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cEZvcm0uanNcIjtcclxuXHJcbmltcG9ydCB7IFBvcHVwSW1hZ2UgfSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwSW1hZ2UuanNcIjtcclxuXHJcbmltcG9ydCB7IFVzZXJJbmZvIH0gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5cclxuaW1wb3J0IHsgUG9wdXBEZWxldGUgfSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwRGVsZXRlLmpzXCI7XHJcblxyXG5pbXBvcnQge1xyXG4gIGZvcm1Db25maWcsXHJcbiAgZm9ybUFkZCxcclxuICBmb3JtRWRpdCxcclxuICBmb3JtQXZhdGFyLFxyXG4gIGFkZFBvcHVwRWxlbWVudCxcclxuICBlZGl0UG9wdXBFbGVtZW50LFxyXG4gIGF2YXRhclBvcHVwRWxlbWVudCxcclxuICBkZWxldGVQb3B1cEVsZW1lbnQsXHJcbiAgYnV0dG9uQWRkLFxyXG4gIGJ1dHRvbkVkaXQsXHJcbiAgbmFtZUlucHV0LFxyXG4gIGpvYklucHV0LFxyXG4gIHBvcHVwSW1hZ2UsXHJcbiAgYXZhdGFySW5wdXQsXHJcbiAgcHJvZmlsZVBpYyxcclxuICBwcm9maWxlUGljQnRuLFxyXG4gIGNhcmRHcmlkXHJcbn0gZnJvbSBcIi4uL3NjcmlwdHMvdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcblxyXG5pbXBvcnQgeyBBcGkgfSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5cclxuLy9pbml0aWFsaXppbmcgYXBpXHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTMtZW5cIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcImI0NTEyOTRiLTQ0ZDktNDY0YS04ODc0LTJkNDEzN2E0ZWIzY1wiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcclxuICB9XHJcbn0pO1xyXG5cclxubGV0IHVzZXJJZDtcclxuXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcclxuICBmdWxsTmFtZTogXCIucHJvZmlsZV9fbmFtZVwiLFxyXG4gIGNhdGVnb3J5OiBcIi5wcm9maWxlX19jYXRlZ29yeVwiLFxyXG4gIHByb2ZpbGVQaWM6IFwiLnByb2ZpbGVfX3BpY3R1cmVcIlxyXG59KTtcclxuXHJcbi8vZ2V0dGluZyBpbml0aWFsIGNhcmRzIGFuZCBwcm9maWxlIGluZm9cclxuXHJcblByb21pc2UuYWxsKFthcGkuZ2V0VXNlckluZm8oKSwgYXBpLmdldEluaXRpYWxDYXJkcygpXSlcclxuICAudGhlbigoW3JlcywgaXRlbXNdKSA9PiB7XHJcbiAgICB1c2VySWQgPSByZXMuaWQ7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMubmFtZSwgcmVzLmFib3V0KTtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbWFnZShyZXMuYXZhdGFyKTtcclxuXHJcbiAgICBjYXJkTGlzdC5yZW5kZXJJdGVtcyhpdGVtcyk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge2NvbnNvbGUubG9nKGVycil9KVxyXG5cclxuLy9zdWJtaXR0aW5nIGNhcmRcclxuXHJcbmNvbnN0IHN1Ym1pdENhcmQgPSAoZGF0YSkgPT4ge1xyXG4gIGNhcmRGb3JtLnNob3dMb2FkaW5nKCk7XHJcbiAgYXBpLmNyZWF0ZUNhcmQoZGF0YSlcclxuICAudGhlbigoY2FyZCkgPT4ge1xyXG4gICAgY29uc3QgbmV3SW1hZ2UgPSByZW5kZXJDYXJkKGNhcmQpO1xyXG4gICAgY2FyZExpc3QucHJlcGVuZChuZXdJbWFnZSk7XHJcbiAgICBjYXJkRm9ybS5jbG9zZSgpO1xyXG4gICAgZm9ybUFkZC5yZXNldCgpO1xyXG4gICAgZm9ybUFkZC5yZXNldFZhbGlkYXRpb25FcnJvcigpO1xyXG4gICAgfSlcclxuICAgIC8vY2FyZExpc3QuYWRkSXRlbShuZXdJbWFnZSk7XHJcbiAgLmNhdGNoKChlcnIpID0+IHsgY29uc29sZS5sb2coZXJyKX0pXHJcbiAgLmZpbmFsbHkoICgpID0+IHsgY2FyZEZvcm0uaGlkZUxvYWRpbmcoKTt9KVxyXG5cclxuXHJcbn1cclxuXHJcbi8vc3VibWl0dGluZyBwcm9maWxlXHJcblxyXG5jb25zdCBzdWJtaXRQcm9maWxlID0gKGRhdGEpID0+IHtcclxuICBwcm9maWxlRm9ybS5zaG93TG9hZGluZygpO1xyXG4gIGFwaS5lZGl0UHJvZmlsZShkYXRhLm5hbWUsIGRhdGEuZGVzY3JpcHRpb24pXHJcbiAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgXHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMubmFtZSwgZGF0YS5kZXNjcmlwdGlvbilcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7IGNvbnNvbGUubG9nKGVycil9KVxyXG4gIC5maW5hbGx5KCAoKSA9PiB7XHJcbiAgICBwcm9maWxlRm9ybS5oaWRlTG9hZGluZygpO1xyXG4gIH0pXHJcbn1cclxuXHJcbi8vc3VibWl0dGluZyBwcm9maWxlIHBpY1xyXG5cclxuY29uc3Qgc3VibWl0QXZhdGFyID0gKGRhdGEpID0+IHtcclxuICBhdmF0YXJGb3JtLnNob3dMb2FkaW5nKCk7XHJcbiAgYXBpLmVkaXRQcm9maWxlUGljKGRhdGEucGljdHVyZSlcclxuICAudGhlbigocmVzKSA9PiB7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW1hZ2UocmVzLnBpY3R1cmUpXHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4geyBjb25zb2xlLmxvZyhlcnIpfSlcclxuICAuZmluYWxseSggKCkgPT4geyBhdmF0YXJGb3JtLmhpZGVMb2FkaW5nKCl9KVxyXG5cclxufVxyXG5cclxuLy9kaXNwbGF5aW5nIGNhcmRzIGluIGdhbGxlcnlcclxuXHJcbmNvbnN0IGNhcmRMaXN0ID0gbmV3IFNlY3Rpb24oXHJcbiAge1xyXG4gICAgLy9pdGVtczogaW5pdGlhbENhcmRzLFxyXG4gICAgcmVuZGVyZXI6IHJlbmRlckNhcmQsXHJcbiAgfSxcclxuICBcIi5ncmlkX19jYXJkc1wiXHJcbik7XHJcblxyXG4vL2NhcmRMaXN0LnJlbmRlckl0ZW1zKCk7XHJcblxyXG4vL3VzZXIgaW5mbyBzZWN0aW9uXHJcblxyXG5jb25zdCBwcm9maWxlRm9ybSA9IG5ldyBQb3B1cEZvcm0oZWRpdFBvcHVwRWxlbWVudCwgc3VibWl0UHJvZmlsZSlcclxucHJvZmlsZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vY2FyZCBzZWN0aW9uXHJcblxyXG5jb25zdCBjYXJkRm9ybSA9IG5ldyBQb3B1cEZvcm0oYWRkUG9wdXBFbGVtZW50LCBzdWJtaXRDYXJkKVxyXG5jYXJkRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy9pbWFnZSBzZWN0aW9uXHJcblxyXG5jb25zdCBpbWFnZU1vZHVsZSA9IG5ldyBQb3B1cEltYWdlKHBvcHVwSW1hZ2UpO1xyXG5pbWFnZU1vZHVsZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy9hdmF0YXIgc2VjdGlvblxyXG5cclxuY29uc3QgYXZhdGFyRm9ybSA9IG5ldyBQb3B1cEZvcm0oYXZhdGFyUG9wdXBFbGVtZW50LCBzdWJtaXRBdmF0YXIpO1xyXG5hdmF0YXJGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL2RlbGV0ZSBzZWN0aW9uXHJcblxyXG5jb25zdCBkZWxldGVGb3JtID0gbmV3IFBvcHVwRGVsZXRlKGRlbGV0ZVBvcHVwRWxlbWVudCk7XHJcbmRlbGV0ZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcblxyXG4vL2FkZGluZyBjYXJkIHRvIGdhbGxlcnlcclxuXHJcbmZ1bmN0aW9uIHJlbmRlckNhcmQoZGF0YSkge1xyXG4gIGNvbnN0IGltYWdlID0gbmV3IENhcmQoZGF0YSwgXHJcbiAgICB1c2VySWQsXHJcbiAgICBcIiNjYXJkXCIsXHJcbiAgICAgKCkgPT4ge1xyXG4gICAgaW1hZ2VNb2R1bGUub3BlbihkYXRhLm5hbWUsIGRhdGEubGluayk7IC8vaGFuZGxlQ2FyZENsaWNrXHJcbiAgfSxcclxuICAoKSA9PiB7XHJcbiAgICBpZiAoaW1hZ2UuaXNMaWtlZCgpKXtcclxuICAgICAgYXBpLnVubGlrZUNhcmQoaW1hZ2UuZ2V0SWQoKSlcclxuICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICBkYXRhLnNldExpa2VzKHJlcy5saWtlcylcclxuICAgICAgfSlcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICBhcGkubGlrZUNhcmQoaW1hZ2UuZ2V0SWQoKSlcclxuICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICBkYXRhLnNldExpa2VzKHJlcy5saWtlcylcclxuICAgIH0pXHJcbiAgfVxyXG59LCAoKSA9PiB7XHJcbiAgZGVsZXRlRm9ybS5vcGVuKCk7XHJcbiAgZGVsZXRlRm9ybS5zZXRBY3Rpb24oKCkgPT4ge1xyXG4gICAgYXBpLmRlbGV0ZUNhcmQoaW1hZ2UuZ2V0SWQoKSlcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgaW1hZ2UuZGVsZXRlQ2FyZCgpO1xyXG4gICAgICBkZWxldGVGb3JtLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHsgY29uc29sZS5sb2coZXJyKX0pXHJcbiAgLmZpbmFsbHkoICgpID0+IHsgZGVsZXRlRm9ybS5jbG9zZSgpfSlcclxuICB9KVxyXG59XHJcbiAgKTtcclxuICByZXR1cm4gaW1hZ2UuZ2VuZXJhdGVDYXJkKCk7XHJcbn1cclxuXHJcblxyXG4vL2dldHRpbmcgdGhlIGN1cnJlbnQgdXNlciBpbmZvXHJcblxyXG5cclxuXHJcbmZ1bmN0aW9uIHJlbmRlclByb2ZpbGUoKXtcclxuICBjb25zdCBwcm9maWxlID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuXHJcbiAgbmFtZUlucHV0LnZhbHVlID0gcHJvZmlsZS5uYW1lXHJcbiAgam9iSW5wdXQudmFsdWUgPSBwcm9maWxlLmRlc2NyaXB0aW9uO1xyXG4gIFxyXG4gIGVkaXRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbkVycm9yKCk7XHJcbiAgcHJvZmlsZUZvcm0ub3BlbigpO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW5kZXJBdmF0YXIoKXtcclxuICBjb25zdCBwcm9maWxlID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBhdmF0YXJJbnB1dC52YWx1ZSA9IHByb2ZpbGUucGljdHVyZTtcclxuXHJcbiAgYXZhdGFyRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb25FcnJvcigpO1xyXG4gIGF2YXRhckZvcm0ub3BlbigpO1xyXG59XHJcblxyXG5cclxuLy9oYW5kbGVyc1xyXG5cclxuYnV0dG9uRWRpdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgcmVuZGVyUHJvZmlsZSk7XHJcblxyXG5idXR0b25BZGQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbkVycm9yKCk7XHJcbiAgY2FyZEZvcm0ub3BlbigpO1xyXG59KTtcclxuXHJcbnByb2ZpbGVQaWNCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHJlbmRlckF2YXRhcilcclxuXHJcblxyXG4vL3ZhbGlkYXRvciBzZXR0aW5nc1xyXG5cclxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtQ29uZmlnLCBmb3JtRWRpdCk7XHJcbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtQ29uZmlnLCBmb3JtQWRkKTtcclxuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1Db25maWcsIGZvcm1BdmF0YXIpO1xyXG5cclxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5hZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuYXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7IiwiICBleHBvcnQgY2xhc3MgQXBpIHtcclxuICAgIGNvbnN0cnVjdG9yKHtiYXNlVXJsLCBoZWFkZXJzfSl7XHJcbiAgICAgICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICAgICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgICB9O1xyXG5cclxuXHJcbiAgICBmZXRjaGVyID0gKHVybCwgaGVhZGVyKSA9PiBcclxuICAgIGZldGNoKHVybCwgaGVhZGVyKS50aGVuKChyZXMpID0+XHJcbiAgICByZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QoYFNvbWV0aGluZyB3ZW50IHdyb25nOiAke3Jlcy5zdGF0dXN9YClcclxuICAgICAgKTsgXHJcblxyXG4gICAgZ2V0VXNlckluZm8oKXtcclxuICAgICAgICByZXR1cm4gZmV0Y2hlcihgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgZWRpdFByb2ZpbGUoZGF0YSl7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoZXIgKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgYWJvdXQ6IGRhdGEuZGVzY3JpcHRpb25cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9XHJcbiAgICBlZGl0UHJvZmlsZVBpYyhkYXRhKXtcclxuICAgICAgICByZXR1cm4gZmV0Y2hlciAoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgYXZhdGFyOiBkYXRhLnBpY3R1cmVcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgZ2V0SW5pdGlhbENhcmRzKCl7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoZXIoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG4gICAgY3JlYXRlQ2FyZChkYXRhKXtcclxuICAgICAgICByZXR1cm4gZmV0Y2hlciAoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IGRhdGEudGl0bGUsXHJcbiAgICAgICAgICAgICAgICBsaW5rOiBkYXRhLmxpbmtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGxpa2VDYXJkKGlkKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoZXIoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtpZH1gLCB7XHJcbiAgICAgICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICBcclxuICAgIHVubGlrZUNhcmQoaWQpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2hlcihgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2lkfWAsIHtcclxuICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIFxyXG4gICAgZGVsZXRlQ2FyZChpZCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaGVyKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICB9XHJcbiAgICBcclxuICB9XHJcbiIsImV4cG9ydCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7IGZ1bGxOYW1lLCBjYXRlZ29yeSwgcHJvZmlsZVBpYyB9KSB7XHJcbiAgICAgIHRoaXMuX2Z1bGxOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihmdWxsTmFtZSk7XHJcbiAgICAgIHRoaXMuX2NhdGVnb3J5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihjYXRlZ29yeSk7XHJcbiAgICAgIHRoaXMuX3Byb2ZpbGVQaWMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVQaWMpO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgbmFtZTogdGhpcy5fZnVsbE5hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuX2NhdGVnb3J5LnRleHRDb250ZW50LFxyXG4gICAgICAgIHBpY3R1cmU6IHRoaXMuX3Byb2ZpbGVQaWMuc3JjXHJcbiAgICAgIH1cclxuICAgIH1cclxuICBcclxuICAgIHNldFVzZXJJbmZvKCBuYW1lLCBkZXNjcmlwdGlvbiApIHtcclxuICAgICAgdGhpcy5fZnVsbE5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgICB0aGlzLl9jYXRlZ29yeS50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xyXG4gICAgfVxyXG5cclxuICAgIHNldFVzZXJJbWFnZShwaWN0dXJlKXtcclxuICAgICAgdGhpcy5fcHJvZmlsZVBpYy5zcmMgPSBwaWN0dXJlO1xyXG4gICAgfVxyXG5cclxuICB9XHJcbiAgIiwiZXhwb3J0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgcmVuZGVyZXIgfSwgIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgIC8vIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICAvLyBpbnNlcnRzIGVsZW1lbnQgdG8gdGhlIGNvbnRhaW5lclxyXG4gIGFkZEl0ZW0oaXRlbSkge1xyXG4gICAgY29uc3QgZWxlbWVudCA9IHRoaXMuX3JlbmRlcmVyKGl0ZW0pXHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KVxyXG4gIH07XHJcblxyXG4gIC8vIHJlbmRlcnMgaW5pdGlhbCBpdGVtc1xyXG4gIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XHJcbiAgICBpdGVtcy5mb3JFYWNoKChkYXRhKSA9PiB7XHJcbiAgICAgIHRoaXMuYWRkSXRlbShkYXRhKVxyXG4gICAgfSlcclxuICB9O1xyXG59IiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwSW1hZ2UgZXh0ZW5kcyBQb3B1cHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwRWxlbWVudCl7XHJcbiAgICAgICAgc3VwZXIocG9wdXBFbGVtZW50KTtcclxuXHJcbiAgICAgICAgdGhpcy5faW1hZ2VUaXRsZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmltYWdlX190aXRsZVwiKTtcclxuICAgICAgICB0aGlzLl9pbWFnZVByZXZpZXcgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5pbWFnZV9fZmlsZVwiKTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuKHRpdGxlLCBsaW5rKXtcclxuICAgIFxyXG4gICAgICAgIHN1cGVyLm9wZW4oKVxyXG4gICAgdGhpcy5faW1hZ2VQcmV2aWV3LnNyYyA9IGxpbms7XHJcbiAgICB0aGlzLl9pbWFnZVByZXZpZXcuYWx0ID0gdGl0bGU7XHJcbiAgICB0aGlzLl9pbWFnZVRpdGxlLnRleHRDb250ZW50ID0gdGl0bGU7XHJcblxyXG4gXHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBEZWxldGUgZXh0ZW5kcyBQb3B1cHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwRWxlbWVudCl7XHJcbiAgICAgICAgc3VwZXIocG9wdXBFbGVtZW50KVxyXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjc3VibWl0QnV0dG9uXCIpO1xyXG4gICAgICAgIC8vdGhpcy5fY2FuY2VsQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FuY2VsQnV0dG9uXCIpO1xyXG4gICAgICAgIHRoaXMuX3RleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0QWN0aW9uKGFjdGlvbil7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlU3VibWl0ID0gYWN0aW9uOyBcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpe1xyXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlU3VibWl0KCk7XHJcblxyXG4gICAgICAgIH0pXHJcbiAgICAgICAvLyB0aGlzLl9jYW5jZWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHtcclxuICAgICAgICAgICAgLy90aGlzLl9mb3JtRWxlbWVudC5jbG9zZSgpO1xyXG4gICAgICAgLy8gfSlcclxuICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcbn0iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsInVzZXJJZCIsImNhcmRTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZUxpa2UiLCJoYW5kbGVEZWxldGUiLCJ0aGlzIiwiX2xpa2VzIiwic29tZSIsInVzZXIiLCJfaWQiLCJfdXNlcklkIiwiX2VsZW1lbnQiLCJyZW1vdmUiLCJfZGF0YSIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsImxpa2VzIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVMaWtlIiwiX2hhbmRsZURlbGV0ZSIsIl9oYW5kbGVDYXJkQ2xpY2siLCJnZXRJZCIsIl9nZXRUZW1wbGF0ZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJnZW5lcmF0ZUNhcmQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJjYXJkSW1hZ2UiLCJjYXJkVGl0bGUiLCJzdHlsZSIsImJhY2tncm91bmRJbWFnZSIsInRleHRDb250ZW50IiwiX3JlbmRlckxpa2VzIiwiYWRkRXZlbnRMaXN0ZW5lciIsInNldExpa2VzIiwiY2FyZExpa2UiLCJsZW5ndGgiLCJpc0xpa2VkIiwiY2xhc3NMaXN0IiwiYWRkIiwiY29uZmlnIiwiZm9ybUVsZW1lbnQiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJpZCIsIl9pbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfaW5wdXRMaXN0IiwiX2J1dHRvbkVsZW1lbnQiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImRpc2FibGVkIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX2ZpZWxkc2V0U2VsZWN0b3IiLCJmaWVsZHNldFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJyZXNldFZhbGlkYXRpb25FcnJvciIsImZvckVhY2giLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJlbmFibGVWYWxpZGF0aW9uIiwiUG9wdXAiLCJwb3B1cEVsZW1lbnQiLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0IiwiY2xvc2UiLCJfcG9wdXBFbGVtZW50IiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIl9oYW5kbGVMYXlvdmVyQ2xvc2UiLCJrZXkiLCJvcGVuIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwiY29udGFpbnMiLCJQb3B1cEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0IiwiYnV0dG9uVGV4dCIsImxvYWRpbmdCdXR0b25UZXh0Iiwic3VwZXIiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9mb3JtRWxlbWVudCIsIl9sb2FkaW5nQnV0dG9uVGV4dCIsIl9zdWJtaXRCdXR0b24iLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dHMiLCJpbnB1dCIsInZhbHVlIiwiZSIsInNob3dMb2FkaW5nIiwiaGlkZUxvYWRpbmciLCJzZXRJbnB1dFZhbHVlcyIsIl9pbnB1dHMiLCJyZXNldCIsInByb2ZpbGVQaWNCdG4iLCJwb3B1cEltYWdlIiwiYnV0dG9uRWRpdCIsImdldEVsZW1lbnRCeUlkIiwiZm9ybUVkaXQiLCJmb3JtQXZhdGFyIiwiZWRpdFBvcHVwRWxlbWVudCIsImFkZFBvcHVwRWxlbWVudCIsImF2YXRhclBvcHVwRWxlbWVudCIsImRlbGV0ZVBvcHVwRWxlbWVudCIsIm5hbWVJbnB1dCIsImpvYklucHV0IiwiYXZhdGFySW5wdXQiLCJidXR0b25BZGQiLCJmb3JtQWRkIiwiZm9ybUNvbmZpZyIsImZvcm1TZWxlY3RvciIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwidXJsIiwiaGVhZGVyIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJnZXRVc2VySW5mbyIsImZldGNoZXIiLCJlZGl0UHJvZmlsZSIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJkZXNjcmlwdGlvbiIsImVkaXRQcm9maWxlUGljIiwiYXZhdGFyIiwicGljdHVyZSIsImdldEluaXRpYWxDYXJkcyIsImNyZWF0ZUNhcmQiLCJ0aXRsZSIsImxpa2VDYXJkIiwidW5saWtlQ2FyZCIsImRlbGV0ZUNhcmQiLCJhdXRob3JpemF0aW9uIiwidXNlckluZm8iLCJmdWxsTmFtZSIsImNhdGVnb3J5IiwicHJvZmlsZVBpYyIsIl9mdWxsTmFtZSIsIl9jYXRlZ29yeSIsIl9wcm9maWxlUGljIiwic3JjIiwic2V0VXNlckluZm8iLCJzZXRVc2VySW1hZ2UiLCJhbGwiLCJpdGVtcyIsImNhcmRMaXN0IiwicmVuZGVySXRlbXMiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJjb250YWluZXJTZWxlY3RvciIsInJlbmRlcmVyIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImFkZEl0ZW0iLCJpdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJyZW5kZXJDYXJkIiwicHJvZmlsZUZvcm0iLCJmaW5hbGx5IiwiY2FyZEZvcm0iLCJjYXJkIiwibmV3SW1hZ2UiLCJpbWFnZU1vZHVsZSIsIl9pbWFnZVRpdGxlIiwiX2ltYWdlUHJldmlldyIsImFsdCIsImF2YXRhckZvcm0iLCJkZWxldGVGb3JtIiwiX3RleHQiLCJzZXRBY3Rpb24iLCJhY3Rpb24iLCJfaGFuZGxlU3VibWl0IiwiaW1hZ2UiLCJwcm9maWxlIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJhZGRGb3JtVmFsaWRhdG9yIiwiYXZhdGFyRm9ybVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiXSwic291cmNlUm9vdCI6IiJ9